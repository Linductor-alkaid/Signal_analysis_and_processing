<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿«é€Ÿå‚…é‡Œå¶å˜æ¢(FFT)</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        
        .knowledge-point {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .formula {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            font-family: 'Times New Roman', serif;
            font-size: 18px;
        }
        
        .important {
            background: #ffeaa7;
            border: 2px solid #fdcb6e;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .example {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .plot-container {
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        canvas {
            border: 1px solid #ccc;
            margin: 10px;
        }
        
        .controls {
            margin: 15px 0;
            text-align: center;
        }
        
        .controls input, .controls select {
            margin: 5px;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .controls button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        .controls button:hover {
            background: #2980b9;
        }
        
        .exercise {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .exercise h4 {
            color: #2e7d2e;
            margin-top: 0;
        }
        
        .answer {
            background: #f0f0f0;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            display: none;
        }
        
        .show-answer {
            background: #28a745;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .show-answer:hover {
            background: #218838;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        
        th {
            background: #f2f2f2;
        }
        
        .highlight {
            background: #ffeb3b;
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        .problem-box {
            background: #ffebee;
            border: 2px solid #f44336;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .solution-box {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .complexity-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .complexity-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .butterfly-demo {
            background: #f0f8ff;
            border: 1px solid #87ceeb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .algorithm-steps {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .algorithm-steps ol {
            margin: 0;
            padding-left: 20px;
        }
        
        .flow-graph {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }
        
        .stage {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 20px;
        }
        
        .stage-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2980b9;
        }
        
        .node {
            width: 30px;
            height: 30px;
            border: 2px solid #3498db;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 5px 0;
            font-size: 12px;
        }
        
        .performance-chart {
            background: #fafafa;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä¿¡å·åˆ†æä¸å¤„ç† - ç¬¬å…­ç« ï¼šå¿«é€Ÿå‚…é‡Œå¶å˜æ¢(FFT)</h1>
        
        <h2>6.1 ç›´æ¥DFTè¿ç®—çš„é—®é¢˜</h2>
        
        <div class="problem-box">
            <h3>ğŸš¨ ç›´æ¥DFTè®¡ç®—çš„è®¡ç®—é‡é—®é¢˜</h3>
            <p>å›é¡¾DFTçš„å®šä¹‰ï¼š</p>
            <div class="formula">
                X[k] = âˆ‘<sub>n=0</sub><sup>N-1</sup> x[n]W<sub>N</sub><sup>kn</sup>, k = 0, 1, ..., N-1
            </div>
            
            <h4>è®¡ç®—å¤æ‚åº¦åˆ†æï¼š</h4>
            <ul>
                <li><strong>å¤æ•°ä¹˜æ³•æ¬¡æ•°</strong>ï¼šæ¯ä¸ªX[k]éœ€è¦Næ¬¡å¤æ•°ä¹˜æ³•ï¼Œå…±Nä¸ªX[k] â†’ NÂ²æ¬¡</li>
                <li><strong>å¤æ•°åŠ æ³•æ¬¡æ•°</strong>ï¼šæ¯ä¸ªX[k]éœ€è¦N-1æ¬¡å¤æ•°åŠ æ³•ï¼Œå…±Nä¸ªX[k] â†’ N(N-1)æ¬¡</li>
                <li><strong>æ€»è®¡ç®—é‡</strong>ï¼šO(NÂ²)</li>
            </ul>
            
            <div class="important">
                <h4>å®é™…æ•°æ®å¯¹æ¯”</h4>
                <table>
                    <tr>
                        <th>åºåˆ—é•¿åº¦N</th>
                        <th>ç›´æ¥DFTä¹˜æ³•æ¬¡æ•°</th>
                        <th>è®¡ç®—æ—¶é—´ä¼°è®¡</th>
                    </tr>
                    <tr>
                        <td>64</td>
                        <td>4,096</td>
                        <td>4ms</td>
                    </tr>
                    <tr>
                        <td>1,024</td>
                        <td>1,048,576</td>
                        <td>1s</td>
                    </tr>
                    <tr>
                        <td>4,096</td>
                        <td>16,777,216</td>
                        <td>16s</td>
                    </tr>
                    <tr>
                        <td>65,536</td>
                        <td>4,294,967,296</td>
                        <td>1å°æ—¶</td>
                    </tr>
                </table>
                <p class="highlight">éšç€Nçš„å¢é•¿ï¼Œè®¡ç®—é‡å‘ˆå¹³æ–¹çº§å¢é•¿ï¼Œå®é™…åº”ç”¨ä¸­æ— æ³•æ¥å—ï¼</p>
            </div>
        </div>
        
        <h2>6.2 FFTçš„æ”¹è¿›æ€è·¯</h2>
        
        <div class="solution-box">
            <h3>ğŸ’¡ åˆ†æ²»ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³</h3>
            <p>FFTç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯<strong>åˆ†æ²»æ³•(Divide and Conquer)</strong>ï¼š</p>
            
            <h4>1. å¯åˆ†æ€§åˆ†æ</h4>
            <ul>
                <li><strong>é—®é¢˜</strong>ï¼šè®¡ç®—Nç‚¹DFT</li>
                <li><strong>åˆ†è§£</strong>ï¼šåˆ†è§£ä¸ºä¸¤ä¸ªN/2ç‚¹DFT</li>
                <li><strong>åˆå¹¶</strong>ï¼šé€šè¿‡ç®€å•è¿ç®—åˆå¹¶ç»“æœ</li>
                <li><strong>æ¡ä»¶</strong>ï¼šN = 2áµï¼ˆåŸº-2 FFTï¼‰</li>
            </ul>
            
            <h4>2. å¤æ‚åº¦åˆ†æ</h4>
            <div class="formula">
                T(N) = 2T(N/2) + O(N) = O(N log N)
            </div>
            
            <div class="complexity-comparison">
                <div class="complexity-item">
                    <h4>ç›´æ¥DFT</h4>
                    <p><strong>å¤æ‚åº¦ï¼šO(NÂ²)</strong></p>
                    <p>ä¹˜æ³•æ¬¡æ•°ï¼šNÂ²</p>
                    <p>ä¸å¯å®ç”¨äºå¤§N</p>
                </div>
                <div class="complexity-item">
                    <h4>FFTç®—æ³•</h4>
                    <p><strong>å¤æ‚åº¦ï¼šO(N log N)</strong></p>
                    <p>ä¹˜æ³•æ¬¡æ•°ï¼š(N/2)logâ‚‚N</p>
                    <p>å®é™…åº”ç”¨çš„åŸºç¡€</p>
                </div>
            </div>
        </div>
        
        <div class="performance-chart">
            <h3>æ€§èƒ½å¯¹æ¯”å›¾è¡¨</h3>
            <canvas id="performanceChart" width="800" height="300"></canvas>
        </div>
        
        <h2>6.3 åŸº-2æŒ‰æ—¶é—´æŠ½å–FFTç®—æ³•ï¼ˆDIT-FFTï¼‰</h2>
        
        <div class="knowledge-point">
            <h3>ç®—æ³•åŸºæœ¬åŸç†</h3>
            <p><strong>æ—¶é—´æŠ½å–(Decimation-in-Time, DIT)</strong>ï¼šåœ¨æ—¶åŸŸå°†è¾“å…¥åºåˆ—æŒ‰å¥‡å¶åˆ†ç»„</p>
            
            <h4>ç¬¬ä¸€æ­¥ï¼šåºåˆ—åˆ†ç»„</h4>
            <p>å°†Nç‚¹åºåˆ—x[n]åˆ†ä¸ºå¶æ•°ç»„å’Œå¥‡æ•°ç»„ï¼š</p>
            <div class="formula">
                xâ‚[r] = x[2r], r = 0, 1, ..., N/2-1 ï¼ˆå¶æ•°ç»„ï¼‰<br>
                xâ‚‚[r] = x[2r+1], r = 0, 1, ..., N/2-1 ï¼ˆå¥‡æ•°ç»„ï¼‰
            </div>
            
            <h4>ç¬¬äºŒæ­¥ï¼šDFTåˆ†è§£</h4>
            <div class="formula">
                X[k] = âˆ‘<sub>r=0</sub><sup>N/2-1</sup> x[2r]W<sub>N</sub><sup>2rk</sup> + âˆ‘<sub>r=0</sub><sup>N/2-1</sup> x[2r+1]W<sub>N</sub><sup>(2r+1)k</sup>
            </div>
            
            <h4>ç¬¬ä¸‰æ­¥ï¼šåˆ©ç”¨æ—‹è½¬å› å­æ€§è´¨</h4>
            <p>åˆ©ç”¨ W<sub>N</sub><sup>2</sup> = W<sub>N/2</sub>ï¼š</p>
            <div class="formula">
                X[k] = âˆ‘<sub>r=0</sub><sup>N/2-1</sup> xâ‚[r]W<sub>N/2</sub><sup>rk</sup> + W<sub>N</sub><sup>k</sup>âˆ‘<sub>r=0</sub><sup>N/2-1</sup> xâ‚‚[r]W<sub>N/2</sub><sup>rk</sup>
            </div>
            
            <h4>ç¬¬å››æ­¥ï¼šå¾—åˆ°é€’å½’å…³ç³»</h4>
            <div class="formula">
                X[k] = Xâ‚[k] + W<sub>N</sub><sup>k</sup>Xâ‚‚[k]<br>
                X[k + N/2] = Xâ‚[k] - W<sub>N</sub><sup>k</sup>Xâ‚‚[k]
            </div>
            <p>å…¶ä¸­ k = 0, 1, ..., N/2-1</p>
        </div>
        
        <div class="butterfly-demo">
            <h3>ğŸ¦‹ è¶å½¢è¿ç®—å•å…ƒ</h3>
            <p>FFTçš„åŸºæœ¬è®¡ç®—å•å…ƒæ˜¯<strong>è¶å½¢è¿ç®—(Butterfly Operation)</strong>ï¼š</p>
            <canvas id="butterflyDiagram" width="400" height="200"></canvas>
            <div class="formula">
                A' = A + W<sub>N</sub><sup>r</sup> Ã— B<br>
                B' = A - W<sub>N</sub><sup>r</sup> Ã— B
            </div>
            <p><strong>ç‰¹ç‚¹ï¼š</strong>ä¸€æ¬¡è¶å½¢è¿ç®—éœ€è¦1æ¬¡å¤æ•°ä¹˜æ³•å’Œ2æ¬¡å¤æ•°åŠ æ³•</p>
        </div>
        
        <div class="algorithm-steps">
            <h3>å®Œæ•´ç®—æ³•æ­¥éª¤</h3>
            <ol>
                <li><strong>ä½ååºæ’åˆ—</strong>ï¼šå°†è¾“å…¥åºåˆ—æŒ‰ä½ååºé‡æ–°æ’åˆ—</li>
                <li><strong>å¤šçº§è¶å½¢è¿ç®—</strong>ï¼šè¿›è¡Œlogâ‚‚Nçº§è¶å½¢è¿ç®—</li>
                <li><strong>æ¯çº§å¤„ç†</strong>ï¼šæ¯çº§æœ‰N/2ä¸ªè¶å½¢è¿ç®—å•å…ƒ</li>
                <li><strong>æ—‹è½¬å› å­æ›´æ–°</strong>ï¼šæ¯çº§çš„æ—‹è½¬å› å­æŒ‰è§„å¾‹å˜åŒ–</li>
            </ol>
        </div>
        
        <div class="plot-container">
            <h3>8ç‚¹FFTä¿¡å·æµå›¾æ¼”ç¤º</h3>
            <canvas id="fftFlowGraph" width="800" height="400"></canvas>
            <div class="controls">
                <label>æ¼”ç¤ºç‚¹æ•°ï¼š</label>
                <select id="fftPoints">
                    <option value="4">4ç‚¹FFT</option>
                    <option value="8" selected>8ç‚¹FFT</option>
                    <option value="16">16ç‚¹FFT</option>
                </select>
                <button onclick="drawFFTFlowGraph()">ç»˜åˆ¶ä¿¡å·æµå›¾</button>
            </div>
        </div>
        
        <h2>6.4 ä½ååº(Bit-Reversal)è¯¦è§£</h2>
        
        <div class="knowledge-point">
            <h3>ä½ååºçš„å¿…è¦æ€§</h3>
            <p>ç”±äºé€’å½’åˆ†è§£çš„è¿‡ç¨‹ï¼Œè¾“å…¥åºåˆ—éœ€è¦æŒ‰ç…§<strong>ä½ååº</strong>çš„é¡ºåºæ’åˆ—ï¼š</p>
            
            <div class="example">
                <h4>8ç‚¹FFTä½ååºç¤ºä¾‹</h4>
                <table>
                    <tr>
                        <th>åŸå§‹ç´¢å¼•</th>
                        <th>äºŒè¿›åˆ¶</th>
                        <th>ä½ååºäºŒè¿›åˆ¶</th>
                        <th>ä½ååºç´¢å¼•</th>
                        <th>è¾“å…¥é¡ºåº</th>
                    </tr>
                    <tr>
                        <td>0</td>
                        <td>000</td>
                        <td>000</td>
                        <td>0</td>
                        <td>x[0]</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>001</td>
                        <td>100</td>
                        <td>4</td>
                        <td>x[4]</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>010</td>
                        <td>010</td>
                        <td>2</td>
                        <td>x[2]</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>011</td>
                        <td>110</td>
                        <td>6</td>
                        <td>x[6]</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>100</td>
                        <td>001</td>
                        <td>1</td>
                        <td>x[1]</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>101</td>
                        <td>101</td>
                        <td>5</td>
                        <td>x[5]</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>110</td>
                        <td>011</td>
                        <td>3</td>
                        <td>x[3]</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>111</td>
                        <td>111</td>
                        <td>7</td>
                        <td>x[7]</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <div class="plot-container">
            <h3>ä½ååºè®¡ç®—å™¨</h3>
            <div class="controls">
                <label>è¾“å…¥åºåˆ—é•¿åº¦Nï¼š</label>
                <select id="bitReversalN">
                    <option value="4">4</option>
                    <option value="8">8</option>
                    <option value="16">16</option>
                    <option value="32">32</option>
                </select>
                <button onclick="generateBitReversal()">ç”Ÿæˆä½ååºè¡¨</button>
            </div>
            <div id="bitReversalTable" style="margin-top: 15px;"></div>
        </div>
        
        <h2>6.5 FFTç®—æ³•å¤æ‚åº¦åˆ†æ</h2>
        
        <div class="knowledge-point">
            <h3>è¯¦ç»†å¤æ‚åº¦è®¡ç®—</h3>
            
            <h4>åŸº-2 DIT-FFTå¤æ‚åº¦</h4>
            <ul>
                <li><strong>çº§æ•°</strong>ï¼šlogâ‚‚Nçº§</li>
                <li><strong>æ¯çº§è¶å½¢è¿ç®—æ•°</strong>ï¼šN/2ä¸ª</li>
                <li><strong>æ¯ä¸ªè¶å½¢è¿ç®—</strong>ï¼š1æ¬¡å¤æ•°ä¹˜æ³•ï¼Œ2æ¬¡å¤æ•°åŠ æ³•</li>
                <li><strong>æ€»å¤æ•°ä¹˜æ³•æ¬¡æ•°</strong>ï¼š(N/2)logâ‚‚N</li>
                <li><strong>æ€»å¤æ•°åŠ æ³•æ¬¡æ•°</strong>ï¼šN logâ‚‚N</li>
            </ul>
            
            <div class="important">
                <h4>æ•ˆç‡æå‡å¯¹æ¯”</h4>
                <table>
                    <tr>
                        <th>N</th>
                        <th>ç›´æ¥DFT</th>
                        <th>FFT</th>
                        <th>æå‡å€æ•°</th>
                    </tr>
                    <tr>
                        <td>64</td>
                        <td>4,096</td>
                        <td>192</td>
                        <td>21.3</td>
                    </tr>
                    <tr>
                        <td>1,024</td>
                        <td>1,048,576</td>
                        <td>5,120</td>
                        <td>204.8</td>
                    </tr>
                    <tr>
                        <td>4,096</td>
                        <td>16,777,216</td>
                        <td>24,576</td>
                        <td>682.7</td>
                    </tr>
                    <tr>
                        <td>65,536</td>
                        <td>4,294,967,296</td>
                        <td>524,288</td>
                        <td>8,192</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <div class="plot-container">
            <h3>FFT vs ç›´æ¥DFTæ€§èƒ½å¯¹æ¯”</h3>
            <canvas id="complexityComparison" width="800" height="400"></canvas>
        </div>
        
        <h2>6.6 FFTå®ç°ç¤ºä¾‹</h2>
        
        <div class="plot-container">
            <h3>FFTè®¡ç®—å™¨</h3>
            <canvas id="fftCalculator" width="800" height="300"></canvas>
            <div class="controls">
                <label>è¾“å…¥åºåˆ—(å®éƒ¨,ç”¨é€—å·åˆ†éš”)ï¼š</label>
                <input type="text" id="fftInput" value="1,1,0,0,0,0,0,0" placeholder="ä¾‹: 1,1,0,0,0,0,0,0">
                <button onclick="calculateFFT()">è®¡ç®—FFT</button>
                <button onclick="compareWithDFT()">ä¸DFTå¯¹æ¯”</button>
            </div>
            <div id="fftResult" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px;"></div>
        </div>
        
        <h2>ç»ƒä¹ é¢˜ç›®</h2>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 1ï¼šä½ååºæ’åˆ—</h4>
            <p>å¯¹äº16ç‚¹FFTï¼Œå†™å‡ºè¾“å…¥åºåˆ—x[0], x[1], ..., x[15]çš„ä½ååºæ’åˆ—é¡ºåº</p>
            <button class="show-answer" onclick="toggleAnswer('answer1')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer1" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                ä½ååºåçš„é¡ºåºä¸ºï¼š<br>
                x[0], x[8], x[4], x[12], x[2], x[10], x[6], x[14], x[1], x[9], x[5], x[13], x[3], x[11], x[7], x[15]
            </div>
        </div>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 2ï¼šè¶å½¢è¿ç®—</h4>
            <p>åœ¨8ç‚¹FFTçš„ç¬¬2çº§ä¸­ï¼Œè®¡ç®—ä»¥ä¸‹è¶å½¢è¿ç®—ï¼š</p>
            <p>A = 2+j, B = 1-j, æ—‹è½¬å› å­ Wâ‚ˆÂ² = -j</p>
            <p>æ±‚è¾“å‡º A' å’Œ B'</p>
            <button class="show-answer" onclick="toggleAnswer('answer2')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer2" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                A' = A + Wâ‚ˆÂ² Ã— B = (2+j) + (-j) Ã— (1-j) = (2+j) + (-j+jÂ²) = (2+j) + (-j-1) = 1<br>
                B' = A - Wâ‚ˆÂ² Ã— B = (2+j) - (-j-1) = (2+j) + (j+1) = 3+2j
            </div>
        </div>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 3ï¼šå¤æ‚åº¦è®¡ç®—</h4>
            <p>è®¡ç®—1024ç‚¹FFTå’Œç›´æ¥DFTçš„å¤æ•°ä¹˜æ³•æ¬¡æ•°ï¼Œå¹¶æ±‚å‡ºFFTçš„åŠ é€Ÿæ¯”</p>
            <button class="show-answer" onclick="toggleAnswer('answer3')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer3" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                ç›´æ¥DFTï¼šNÂ² = 1024Â² = 1,048,576æ¬¡<br>
                FFTï¼š(N/2)logâ‚‚N = 512 Ã— 10 = 5,120æ¬¡<br>
                åŠ é€Ÿæ¯”ï¼š1,048,576 Ã· 5,120 = 204.8å€
            </div>
        </div>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 4ï¼šç®—æ³•åˆ†æ</h4>
            <p>ä¸ºä»€ä¹ˆåŸº-2 FFTè¦æ±‚åºåˆ—é•¿åº¦N = 2áµï¼Ÿå¦‚æœNä¸æ˜¯2çš„å¹‚æ¬¡ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ</p>
            <button class="show-answer" onclick="toggleAnswer('answer4')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer4" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                1. åŸº-2 FFTé€šè¿‡é€’å½’åœ°å°†Nç‚¹DFTåˆ†è§£ä¸ºä¸¤ä¸ªN/2ç‚¹DFTï¼Œè¦æ±‚Nèƒ½è¢«2æ•´é™¤mæ¬¡<br>
                2. å¦‚æœNä¸æ˜¯2çš„å¹‚æ¬¡ï¼Œå¯ä»¥ï¼š<br>
                   - è¡¥é›¶åˆ°ä¸‹ä¸€ä¸ª2çš„å¹‚æ¬¡<br>
                   - ä½¿ç”¨æ··åˆåŸºFFTï¼ˆå¦‚åŸº-4ã€åŸº-8ï¼‰<br>
                   - ä½¿ç”¨ç´ å› æ•°åˆ†è§£çš„FFTç®—æ³•
            </div>
        </div>
        
        <h2>6.7 å­¦ä¹ è¦ç‚¹æ€»ç»“</h2>
        
        <div class="important">
            <h3>ğŸ¯ FFTæ ¸å¿ƒè¦ç‚¹</h3>
            <ol>
                <li><strong>åŠ¨æœºç†è§£</strong>ï¼šç›´æ¥DFTçš„O(NÂ²)å¤æ‚åº¦åœ¨å®é™…ä¸­ä¸å¯æ¥å—</li>
                <li><strong>åˆ†æ²»æ€æƒ³</strong>ï¼šé€’å½’åˆ†è§£æ˜¯FFTçš„æ ¸å¿ƒç®—æ³•æ€æƒ³</li>
                <li><strong>è¶å½¢è¿ç®—</strong>ï¼šFFTçš„åŸºæœ¬è®¡ç®—å•å…ƒï¼Œä½“ç°ç®—æ³•ç²¾é«“</li>
                <li><strong>ä½ååº</strong>ï¼šè¾“å…¥æ•°æ®çš„é‡æ–°æ’åˆ—ï¼Œç®—æ³•å®ç°çš„å…³é”®</li>
                <li><strong>å¤æ‚åº¦ä¼˜åŠ¿</strong>ï¼šä»O(NÂ²)é™åˆ°O(N log N)çš„å·¨å¤§æå‡</li>
                <li><strong>å®é™…æ„ä¹‰</strong>ï¼šä½¿å¤§è§„æ¨¡æ•°å­—ä¿¡å·å¤„ç†æˆä¸ºå¯èƒ½</li>
                <li><strong>ç®—æ³•å˜ç§</strong>ï¼šDITã€DIFã€æ··åˆåŸºç­‰å¤šç§å½¢å¼</li>
            </ol>
        </div>
        
        <div class="solution-box">
            <h3>ğŸš€ FFTçš„å†å²æ„ä¹‰</h3>
            <p>1965å¹´Cooley-Tukeyå‘è¡¨çš„FFTç®—æ³•è¢«èª‰ä¸º"20ä¸–çºªæœ€é‡è¦çš„ç®—æ³•ä¹‹ä¸€"ï¼Œå®ƒï¼š</p>
            <ul>
                <li>ä½¿æ•°å­—ä¿¡å·å¤„ç†ä»ç†è®ºèµ°å‘å®ç”¨</li>
                <li>æ¨åŠ¨äº†æ•°å­—éŸ³é¢‘ã€å›¾åƒå¤„ç†çš„å‘å±•</li>
                <li>æˆä¸ºç°ä»£é€šä¿¡ç³»ç»Ÿçš„åŸºç¡€ç®—æ³•</li>
                <li>å¥ å®šäº†è°±åˆ†æã€æ»¤æ³¢å™¨è®¾è®¡çš„è®¡ç®—åŸºç¡€</li>
            </ul>
        </div>
    </div>

    <script>
        // ç»˜åˆ¶æ€§èƒ½å¯¹æ¯”å›¾è¡¨
        function drawPerformanceChart() {
            const canvas = document.getElementById('performanceChart');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // åæ ‡ç³»è®¾ç½®
            const margin = 60;
            const plotWidth = width - 2 * margin;
            const plotHeight = height - 2 * margin;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            
            // xè½´
            ctx.beginPath();
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();
            
            // yè½´
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.stroke();
            
            // æ•°æ®ç‚¹
            const nValues = [4, 8, 16, 32, 64, 128, 256, 512, 1024];
            const dftComplexity = nValues.map(n => n * n);
            const fftComplexity = nValues.map(n => n * Math.log2(n));
            
            // å½’ä¸€åŒ–
            const maxDFT = Math.max(...dftComplexity);
            const maxFFT = Math.max(...fftComplexity);
            const maxVal = Math.max(maxDFT, maxFFT);
            
            // ç»˜åˆ¶DFTæ›²çº¿
            ctx.strokeStyle = 'red';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            dftComplexity.forEach((val, index) => {
                const x = margin + (index / (nValues.length - 1)) * plotWidth;
                const y = height - margin - (val / maxVal) * plotHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // ç»˜åˆ¶FFTæ›²çº¿
            ctx.strokeStyle = 'blue';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            fftComplexity.forEach((val, index) => {
                const x = margin + (index / (nValues.length - 1)) * plotWidth;
                const y = height - margin - (val / maxVal) * plotHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // æ ‡ç­¾å’Œå›¾ä¾‹
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('åºåˆ—é•¿åº¦ N', width / 2, height - 10);
            
            ctx.save();
            ctx.translate(15, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('è®¡ç®—å¤æ‚åº¦', 0, 0);
            ctx.restore();
            
            // å›¾ä¾‹
            ctx.fillStyle = 'red';
            ctx.fillRect(width - 150, 30, 20, 3);
            ctx.fillStyle = '#333';
            ctx.textAlign = 'left';
            ctx.fillText('ç›´æ¥DFT: O(NÂ²)', width - 125, 35);
            
            ctx.fillStyle = 'blue';
            ctx.fillRect(width - 150, 50, 20, 3);
            ctx.fillStyle = '#333';
            ctx.fillText('FFT: O(N log N)', width - 125, 55);
            
            // xè½´åˆ»åº¦
            nValues.forEach((n, index) => {
                const x = margin + (index / (nValues.length - 1)) * plotWidth;
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                ctx.fillText(n.toString(), x, height - margin + 20);
            });
        }
        
        // ç»˜åˆ¶è¶å½¢è¿ç®—å›¾
        function drawButterflyDiagram() {
            const canvas = document.getElementById('butterflyDiagram');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            const centerX = width / 2;
            const centerY = height / 2;
            const inputY1 = centerY - 40;
            const inputY2 = centerY + 40;
            const outputY1 = centerY - 40;
            const outputY2 = centerY + 40;
            const leftX = 50;
            const rightX = width - 50;
            
            // ç»˜åˆ¶è¾“å…¥è¾“å‡ºç‚¹
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.arc(leftX, inputY1, 8, 0, 2 * Math.PI);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(leftX, inputY2, 8, 0, 2 * Math.PI);
            ctx.fill();
            
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(rightX, outputY1, 8, 0, 2 * Math.PI);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(rightX, outputY2, 8, 0, 2 * Math.PI);
            ctx.fill();
            
            // ç»˜åˆ¶è¿çº¿
            ctx.strokeStyle = '#2980b9';
            ctx.lineWidth = 2;
            
            // ç›´çº¿è¿æ¥
            ctx.beginPath();
            ctx.moveTo(leftX + 8, inputY1);
            ctx.lineTo(rightX - 8, outputY1);
            ctx.stroke();
            
            // äº¤å‰è¿æ¥
            ctx.beginPath();
            ctx.moveTo(leftX + 8, inputY2);
            ctx.lineTo(rightX - 8, outputY1);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(leftX + 8, inputY1);
            ctx.lineTo(rightX - 8, outputY2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(leftX + 8, inputY2);
            ctx.lineTo(rightX - 8, outputY2);
            ctx.stroke();
            
            // æ ‡è®°æ—‹è½¬å› å­
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('W^r', centerX, centerY - 20);
            ctx.fillText('-W^r', centerX, centerY + 30);
            
            // è¾“å…¥è¾“å‡ºæ ‡ç­¾
            ctx.textAlign = 'right';
            ctx.fillText('A', leftX - 15, inputY1 + 5);
            ctx.fillText('B', leftX - 15, inputY2 + 5);
            
            ctx.textAlign = 'left';
            ctx.fillText("A'", rightX + 15, outputY1 + 5);
            ctx.fillText("B'", rightX + 15, outputY2 + 5);
        }
        
        // ç»˜åˆ¶FFTä¿¡å·æµå›¾
        function drawFFTFlowGraph() {
            const canvas = document.getElementById('fftFlowGraph');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            const N = parseInt(document.getElementById('fftPoints').value);
            
            ctx.clearRect(0, 0, width, height);
            
            if (N !== 8) {
                ctx.fillStyle = '#333';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`${N}ç‚¹FFTä¿¡å·æµå›¾ï¼ˆç®€åŒ–æ˜¾ç¤ºï¼‰`, width/2, height/2);
                return;
            }
            
            // 8ç‚¹FFTè¯¦ç»†ä¿¡å·æµå›¾
            const stages = 4; // è¾“å…¥ + 3çº§è¿ç®—
            const stageWidth = width / stages;
            const nodeHeight = height / (N + 1);
            
            // ç»˜åˆ¶å„çº§
            for (let stage = 0; stage < stages; stage++) {
                const x = stageWidth * (stage + 0.5);
                
                // ç»˜åˆ¶èŠ‚ç‚¹
                for (let i = 0; i < N; i++) {
                    const y = nodeHeight * (i + 1);
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 8, 0, 2 * Math.PI);
                    ctx.fillStyle = stage === 0 ? '#3498db' : (stage === stages - 1 ? '#e74c3c' : '#95a5a6');
                    ctx.fill();
                    ctx.strokeStyle = '#2c3e50';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // æ ‡ç­¾
                    if (stage === 0) {
                        ctx.fillStyle = '#333';
                        ctx.font = '10px Arial';
                        ctx.textAlign = 'center';
                        const bitReversed = bitReverse(i, 3);
                        ctx.fillText(`x[${bitReversed}]`, x, y - 15);
                    } else if (stage === stages - 1) {
                        ctx.fillStyle = '#333';
                        ctx.font = '10px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(`X[${i}]`, x, y - 15);
                    }
                }
                
                // ç»˜åˆ¶çº§é—´è¿çº¿ï¼ˆç®€åŒ–ï¼‰
                if (stage < stages - 1) {
                    ctx.strokeStyle = '#7f8c8d';
                    ctx.lineWidth = 1;
                    
                    for (let i = 0; i < N; i += 2) {
                        const y1 = nodeHeight * (i + 1);
                        const y2 = nodeHeight * (i + 2);
                        const x1 = stageWidth * (stage + 0.5) + 8;
                        const x2 = stageWidth * (stage + 1.5) - 8;
                        
                        // ç›´è¿
                        ctx.beginPath();
                        ctx.moveTo(x1, y1);
                        ctx.lineTo(x2, y1);
                        ctx.stroke();
                        
                        ctx.beginPath();
                        ctx.moveTo(x1, y2);
                        ctx.lineTo(x2, y2);
                        ctx.stroke();
                        
                        // äº¤å‰è¿æ¥
                        ctx.beginPath();
                        ctx.moveTo(x1, y1);
                        ctx.lineTo(x2, y2);
                        ctx.stroke();
                        
                        ctx.beginPath();
                        ctx.moveTo(x1, y2);
                        ctx.lineTo(x2, y1);
                        ctx.stroke();
                    }
                }
            }
            
            // çº§æ ‡é¢˜
            const stageNames = ['è¾“å…¥', 'ç¬¬1çº§', 'ç¬¬2çº§', 'è¾“å‡º'];
            stageNames.forEach((name, index) => {
                ctx.fillStyle = '#2980b9';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(name, stageWidth * (index + 0.5), 25);
            });
        }
        
        // ä½ååºå‡½æ•°
        function bitReverse(num, bits) {
            let result = 0;
            for (let i = 0; i < bits; i++) {
                result = (result << 1) | (num & 1);
                num >>= 1;
            }
            return result;
        }
        
        // ç”Ÿæˆä½ååºè¡¨
        function generateBitReversal() {
            const N = parseInt(document.getElementById('bitReversalN').value);
            const bits = Math.log2(N);
            
            let tableHTML = '<h4>ä½ååºå¯¹ç…§è¡¨</h4>';
            tableHTML += '<table style="width: 100%; border-collapse: collapse;">';
            tableHTML += '<tr><th>åŸç´¢å¼•</th><th>äºŒè¿›åˆ¶</th><th>ä½ååºäºŒè¿›åˆ¶</th><th>ä½ååºç´¢å¼•</th></tr>';
            
            for (let i = 0; i < N; i++) {
                const binary = i.toString(2).padStart(bits, '0');
                const reversedBinary = binary.split('').reverse().join('');
                const reversedIndex = parseInt(reversedBinary, 2);
                
                tableHTML += `<tr>
                    <td>${i}</td>
                    <td>${binary}</td>
                    <td>${reversedBinary}</td>
                    <td>${reversedIndex}</td>
                </tr>`;
            }
            
            tableHTML += '</table>';
            document.getElementById('bitReversalTable').innerHTML = tableHTML;
        }
        
        // ç»˜åˆ¶å¤æ‚åº¦å¯¹æ¯”å›¾
        function drawComplexityComparison() {
            const canvas = document.getElementById('complexityComparison');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // åæ ‡ç³»è®¾ç½®
            const margin = 60;
            const plotWidth = width - 2 * margin;
            const plotHeight = height - 2 * margin;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            
            // xè½´
            ctx.beginPath();
            ctx.moveTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();
            
            // yè½´ï¼ˆå¯¹æ•°åæ ‡ï¼‰
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.stroke();
            
            // æ•°æ®
            const nValues = [];
            const dftOps = [];
            const fftOps = [];
            
            for (let n = 4; n <= 1024; n *= 2) {
                nValues.push(n);
                dftOps.push(n * n);
                fftOps.push(n * Math.log2(n) / 2);
            }
            
            // å¯¹æ•°åŒ–
            const logDFT = dftOps.map(x => Math.log10(x));
            const logFFT = fftOps.map(x => Math.log10(x));
            const maxLog = Math.max(...logDFT);
            const minLog = Math.min(...logFFT);
            
            // ç»˜åˆ¶æ›²çº¿
            function drawCurve(data, color, label) {
                ctx.strokeStyle = color;
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                data.forEach((val, index) => {
                    const x = margin + (index / (data.length - 1)) * plotWidth;
                    const y = height - margin - ((val - minLog) / (maxLog - minLog)) * plotHeight;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();
                
                // ç»˜åˆ¶ç‚¹
                ctx.fillStyle = color;
                data.forEach((val, index) => {
                    const x = margin + (index / (data.length - 1)) * plotWidth;
                    const y = height - margin - ((val - minLog) / (maxLog - minLog)) * plotHeight;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, 2 * Math.PI);
                    ctx.fill();
                });
            }
            
            drawCurve(logDFT, '#e74c3c', 'DFT');
            drawCurve(logFFT, '#3498db', 'FFT');
            
            // æ ‡ç­¾
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('åºåˆ—é•¿åº¦ N', width / 2, height - 10);
            
            ctx.save();
            ctx.translate(15, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('è¿ç®—æ¬¡æ•° (logâ‚â‚€)', 0, 0);
            ctx.restore();
            
            // å›¾ä¾‹
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(width - 150, 30, 20, 3);
            ctx.fillStyle = '#333';
            ctx.textAlign = 'left';
            ctx.fillText('ç›´æ¥DFT', width - 125, 35);
            
            ctx.fillStyle = '#3498db';
            ctx.fillRect(width - 150, 50, 20, 3);
            ctx.fillText('FFT', width - 125, 55);
            
            // xè½´åˆ»åº¦
            nValues.forEach((n, index) => {
                const x = margin + (index / (nValues.length - 1)) * plotWidth;
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                ctx.fillText(n.toString(), x, height - margin + 20);
            });
        }
        
        // ç®€å•FFTå®ç°ï¼ˆç”¨äºæ¼”ç¤ºï¼‰
        function simpleFFT(x) {
            const N = x.length;
            if (N <= 1) return x;
            
            // ä½ååº
            const bitReversed = new Array(N);
            const bits = Math.log2(N);
            for (let i = 0; i < N; i++) {
                bitReversed[bitReverse(i, bits)] = x[i];
            }
            
            // è¶å½¢è¿ç®—
            for (let len = 2; len <= N; len *= 2) {
                const step = len / 2;
                for (let i = 0; i < N; i += len) {
                    for (let j = 0; j < step; j++) {
                        const u = bitReversed[i + j];
                        const v = bitReversed[i + j + step];
                        const w = {
                            real: Math.cos(-2 * Math.PI * j / len),
                            imag: Math.sin(-2 * Math.PI * j / len)
                        };
                        
                        // å¤æ•°ä¹˜æ³• v * w
                        const temp = {
                            real: v.real * w.real - v.imag * w.imag,
                            imag: v.real * w.imag + v.imag * w.real
                        };
                        
                        bitReversed[i + j] = {
                            real: u.real + temp.real,
                            imag: u.imag + temp.imag
                        };
                        
                        bitReversed[i + j + step] = {
                            real: u.real - temp.real,
                            imag: u.imag - temp.imag
                        };
                    }
                }
            }
            
            return bitReversed;
        }
        
        // è®¡ç®—FFT
        function calculateFFT() {
            const input = document.getElementById('fftInput').value;
            const sequence = input.split(',').map(x => ({
                real: parseFloat(x.trim()) || 0,
                imag: 0
            })).filter(x => !isNaN(x.real));
            
            if (sequence.length === 0 || (sequence.length & (sequence.length - 1)) !== 0) {
                document.getElementById('fftResult').innerHTML = '<span style="color: red;">è¯·è¾“å…¥é•¿åº¦ä¸º2çš„å¹‚æ¬¡çš„æœ‰æ•ˆåºåˆ—ï¼</span>';
                return;
            }
            
            const result = simpleFFT(sequence);
            
            // æ˜¾ç¤ºç»“æœ
            let resultHTML = '<h4>FFTè®¡ç®—ç»“æœï¼š</h4>';
            resultHTML += '<table style="width: 100%; border-collapse: collapse;">';
            resultHTML += '<tr><th>k</th><th>å®éƒ¨</th><th>è™šéƒ¨</th><th>å¹…åº¦</th><th>ç›¸ä½(åº¦)</th></tr>';
            
            result.forEach((coeff, k) => {
                const magnitude = Math.sqrt(coeff.real * coeff.real + coeff.imag * coeff.imag);
                const phase = Math.atan2(coeff.imag, coeff.real) * 180 / Math.PI;
                resultHTML += `<tr>
                    <td>${k}</td>
                    <td>${coeff.real.toFixed(3)}</td>
                    <td>${coeff.imag.toFixed(3)}</td>
                    <td>${magnitude.toFixed(3)}</td>
                    <td>${phase.toFixed(1)}Â°</td>
                </tr>`;
            });
            
            resultHTML += '</table>';
            document.getElementById('fftResult').innerHTML = resultHTML;
            
            // ç»˜åˆ¶ç»“æœ
            plotFFTResult(result);
        }
        
        // ç»˜åˆ¶FFTç»“æœ
        function plotFFTResult(result) {
            const canvas = document.getElementById('fftCalculator');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            const centerY = height * 0.8;
            const scaleX = (width - 60) / (result.length + 1);
            const magnitudes = result.map(c => Math.sqrt(c.real * c.real + c.imag * c.imag));
            const maxMag = Math.max(...magnitudes) || 1;
            const scaleY = (height * 0.5) / maxMag;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(50, 20);
            ctx.lineTo(50, height - 20);
            ctx.stroke();
            
            // ç»˜åˆ¶é¢‘è°±
            ctx.strokeStyle = '#e74c3c';
            ctx.fillStyle = '#e74c3c';
            ctx.lineWidth = 2;
            
            magnitudes.forEach((mag, index) => {
                const x = 50 + (index + 1) * scaleX;
                const y = centerY - mag * scaleY;
                
                // èŒ
                ctx.beginPath();
                ctx.moveTo(x, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                // ç‚¹
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
                
                // æ ‡è®°
                if (index % Math.ceil(result.length / 8) === 0) {
                    ctx.fillStyle = '#333';
                    ctx.font = '10px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(index.toString(), x, centerY + 15);
                    ctx.fillStyle = '#e74c3c';
                }
            });
            
            // æ ‡é¢˜
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('FFTå¹…åº¦è°±', width / 2, 15);
        }
        
        // ä¸DFTå¯¹æ¯”
        function compareWithDFT() {
            const input = document.getElementById('fftInput').value;
            const sequence = input.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
            
            if (sequence.length === 0) return;
            
            // è¡¥é›¶åˆ°2çš„å¹‚æ¬¡
            let N = 1;
            while (N < sequence.length) N *= 2;
            while (sequence.length < N) sequence.push(0);
            
            const start = performance.now();
            
            // è®¡ç®—FFT
            const fftInput = sequence.map(x => ({real: x, imag: 0}));
            const fftResult = simpleFFT(fftInput);
            const fftTime = performance.now() - start;
            
            // è®¡ç®—ç›´æ¥DFTï¼ˆç”¨äºå¯¹æ¯”ï¼‰
            const dftStart = performance.now();
            const dftResult = calculateDFTDirect(sequence);
            const dftTime = performance.now() - dftStart;
            
            // æ˜¾ç¤ºå¯¹æ¯”ç»“æœ
            let compareHTML = '<h4>FFT vs DFTæ€§èƒ½å¯¹æ¯”ï¼š</h4>';
            compareHTML += `<p>åºåˆ—é•¿åº¦ï¼š${N}</p>`;
            compareHTML += `<p>FFTè®¡ç®—æ—¶é—´ï¼š${fftTime.toFixed(3)} ms</p>`;
            compareHTML += `<p>DFTè®¡ç®—æ—¶é—´ï¼š${dftTime.toFixed(3)} ms</p>`;
            compareHTML += `<p>åŠ é€Ÿæ¯”ï¼š${(dftTime / fftTime).toFixed(1)}x</p>`;
            
            document.getElementById('fftResult').innerHTML = compareHTML;
        }
        
        // ç›´æ¥DFTè®¡ç®—
        function calculateDFTDirect(x) {
            const N = x.length;
            const X = [];
            
            for (let k = 0; k < N; k++) {
                let real = 0;
                let imag = 0;
                
                for (let n = 0; n < N; n++) {
                    const angle = -2 * Math.PI * k * n / N;
                    real += x[n] * Math.cos(angle);
                    imag += x[n] * Math.sin(angle);
                }
                
                X.push({real: real, imag: imag});
            }
            
            return X;
        }
        
        // åˆ‡æ¢ç­”æ¡ˆæ˜¾ç¤º
        function toggleAnswer(answerId) {
            const answer = document.getElementById(answerId);
            answer.style.display = answer.style.display === 'none' ? 'block' : 'none';
        }
        
        // é¡µé¢åŠ è½½ååˆå§‹åŒ–
        window.onload = function() {
            drawPerformanceChart();
            drawButterflyDiagram();
            drawFFTFlowGraph();
            generateBitReversal();
            drawComplexityComparison();
            calculateFFT();
        };
    </script>
</body>
</html>