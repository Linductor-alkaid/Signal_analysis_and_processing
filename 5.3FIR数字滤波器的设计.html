<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿¡å·åˆ†æä¸å¤„ç† - FIRæ•°å­—æ»¤æ³¢å™¨çš„è®¾è®¡</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        
        .knowledge-point {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .formula {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            font-family: 'Times New Roman', serif;
            font-size: 18px;
        }
        
        .important {
            background: #ffeaa7;
            border: 2px solid #fdcb6e;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .example {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .plot-container {
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        canvas {
            border: 1px solid #ccc;
            margin: 10px;
        }
        
        .controls {
            margin: 15px 0;
            text-align: center;
        }
        
        .controls input, .controls select {
            margin: 5px;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .controls button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        .controls button:hover {
            background: #2980b9;
        }
        
        .exercise {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .exercise h4 {
            color: #2e7d2e;
            margin-top: 0;
        }
        
        .answer {
            background: #f0f0f0;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            display: none;
        }
        
        .show-answer {
            background: #28a745;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .show-answer:hover {
            background: #218838;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        
        th {
            background: #f2f2f2;
        }
        
        .highlight {
            background: #ffeb3b;
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        .fir-box {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .window-box {
            background: #f3e5f5;
            border: 2px solid #9c27b0;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .sampling-box {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .comparison-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .linear-phase-demo {
            background: #fff8e1;
            border: 1px solid #ffb74d;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .window-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .window-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .design-steps {
            background: #f0f8ff;
            border: 1px solid #87ceeb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .design-steps ol {
            margin: 0;
            padding-left: 20px;
        }
        
        .frequency-sampling-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .comparison-table {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .phase-types {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .phase-type {
            background: #f0f8ff;
            border: 1px solid #87ceeb;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ä¿¡å·åˆ†æä¸å¤„ç† - FIRæ•°å­—æ»¤æ³¢å™¨çš„è®¾è®¡</h1>
        
        <div class="important">
            <h3>ğŸ¯ FIRæ»¤æ³¢å™¨åŸºæœ¬æ¦‚å¿µ</h3>
            <p>FIR (Finite Impulse Response) æ•°å­—æ»¤æ³¢å™¨ï¼š<strong>æœ‰é™å†²æ¿€å“åº”æ»¤æ³¢å™¨</strong>ï¼Œå…¶å†²æ¿€å“åº”h[n]åœ¨æœ‰é™ä¸ªé‡‡æ ·ç‚¹åä¸ºé›¶ã€‚</p>
            <div class="formula">
                H(z) = âˆ‘(n=0 to N-1) h[n]z^{-n}
            </div>
            <p>ä¸»è¦ç‰¹ç‚¹ï¼š<strong>ç³»ç»Ÿç¨³å®šã€å¯å®ç°ä¸¥æ ¼çº¿æ€§ç›¸ä½ã€æ— åé¦ˆ</strong></p>
        </div>
        
        <h2>1. çº¿æ€§ç›¸ä½FIRæ•°å­—æ»¤æ³¢å™¨çš„ç‰¹ç‚¹</h2>
        
        <div class="fir-box">
            <h3>ğŸŸ¢ çº¿æ€§ç›¸ä½çš„å®šä¹‰ä¸æ„ä¹‰</h3>
            <p><strong>çº¿æ€§ç›¸ä½</strong>æ˜¯æŒ‡é¢‘ç‡å“åº”çš„ç›¸ä½Ï•(Ï‰)ä¸é¢‘ç‡Ï‰æˆæ­£æ¯”å…³ç³»ï¼š</p>
            <div class="formula">
                Ï•(Ï‰) = -Î±Ï‰ + Î²
            </div>
            <p>å…¶ä¸­Î±ä¸ºå¸¸æ•°ï¼ˆç¾¤å»¶è¿Ÿï¼‰ï¼ŒÎ²ä¸º0æˆ–Ï€ã€‚</p>
            
            <div class="example">
                <h4>çº¿æ€§ç›¸ä½çš„é‡è¦æ€§</h4>
                <ul>
                    <li><strong>æ— ç›¸ä½å¤±çœŸ</strong>ï¼šå„é¢‘ç‡åˆ†é‡ç»è¿‡æ»¤æ³¢å™¨åçš„ç›¸å¯¹æ—¶å»¶ç›¸åŒ</li>
                    <li><strong>æ³¢å½¢ä¿æŒ</strong>ï¼šè¾“å…¥ä¿¡å·æ³¢å½¢åœ¨æ»¤æ³¢ååŸºæœ¬ä¿æŒä¸å˜</li>
                    <li><strong>åº”ç”¨é¢†åŸŸ</strong>ï¼šéŸ³é¢‘å¤„ç†ã€å›¾åƒå¤„ç†ã€é€šä¿¡ç³»ç»Ÿç­‰</li>
                </ul>
            </div>
        </div>
        
        <div class="knowledge-point">
            <h3>çº¿æ€§ç›¸ä½æ¡ä»¶</h3>
            <p>FIRæ»¤æ³¢å™¨å…·æœ‰çº¿æ€§ç›¸ä½çš„<strong>å……è¦æ¡ä»¶</strong>æ˜¯å…¶å†²æ¿€å“åº”å…·æœ‰ç‰¹å®šçš„å¯¹ç§°æ€§ï¼š</p>
            
            <div class="phase-types">
                <div class="phase-type">
                    <h4>ç¬¬ä¸€ç±»çº¿æ€§ç›¸ä½</h4>
                    <div class="formula">h[n] = h[N-1-n]</div>
                    <p><strong>å¶å¯¹ç§°</strong>ï¼ŒNä¸ºå¥‡æ•°</p>
                    <p>Î² = 0ï¼Œé€‚åˆæ‰€æœ‰æ»¤æ³¢å™¨ç±»å‹</p>
                </div>
                <div class="phase-type">
                    <h4>ç¬¬äºŒç±»çº¿æ€§ç›¸ä½</h4>
                    <div class="formula">h[n] = h[N-1-n]</div>
                    <p><strong>å¶å¯¹ç§°</strong>ï¼ŒNä¸ºå¶æ•°</p>
                    <p>Î² = 0ï¼Œä¸é€‚åˆé«˜é€šæ»¤æ³¢å™¨</p>
                </div>
                <div class="phase-type">
                    <h4>ç¬¬ä¸‰ç±»çº¿æ€§ç›¸ä½</h4>
                    <div class="formula">h[n] = -h[N-1-n]</div>
                    <p><strong>å¥‡å¯¹ç§°</strong>ï¼ŒNä¸ºå¥‡æ•°</p>
                    <p>Î² = Ï€/2ï¼Œé€‚åˆå¾®åˆ†å™¨ã€Hilbertå˜æ¢å™¨</p>
                </div>
                <div class="phase-type">
                    <h4>ç¬¬å››ç±»çº¿æ€§ç›¸ä½</h4>
                    <div class="formula">h[n] = -h[N-1-n]</div>
                    <p><strong>å¥‡å¯¹ç§°</strong>ï¼ŒNä¸ºå¶æ•°</p>
                    <p>Î² = Ï€/2ï¼Œé€‚åˆå¾®åˆ†å™¨</p>
                </div>
            </div>
        </div>
        
        <div class="linear-phase-demo">
            <h3>ğŸ“Š ç¾¤å»¶è¿Ÿç‰¹æ€§</h3>
            <p>çº¿æ€§ç›¸ä½FIRæ»¤æ³¢å™¨çš„<strong>ç¾¤å»¶è¿Ÿ</strong>ä¸ºå¸¸æ•°ï¼š</p>
            <div class="formula">
                Ï„_g = -dÏ•(Ï‰)/dÏ‰ = Î± = (N-1)/2
            </div>
            <p>è¿™æ„å‘³ç€æ‰€æœ‰é¢‘ç‡åˆ†é‡éƒ½æœ‰ç›¸åŒçš„æ—¶å»¶ï¼Œä¿è¯äº†ä¿¡å·æ³¢å½¢ä¸å¤±çœŸã€‚</p>
        </div>
        
        <div class="plot-container">
            <h3>çº¿æ€§ç›¸ä½ç‰¹æ€§æ¼”ç¤º</h3>
            <canvas id="linearPhaseDemo" width="800" height="400"></canvas>
            <div class="controls">
                <label>æ»¤æ³¢å™¨é•¿åº¦Nï¼š</label>
                <input type="range" id="filterLength" min="5" max="31" step="2" value="15">
                <span id="lengthValue">15</span>
                <label>å¯¹ç§°ç±»å‹ï¼š</label>
                <select id="symmetryType">
                    <option value="even">å¶å¯¹ç§°</option>
                    <option value="odd">å¥‡å¯¹ç§°</option>
                </select>
                <button onclick="updateLinearPhase()">æ›´æ–°æ¼”ç¤º</button>
            </div>
        </div>
        
        <h2>2. çª—å‡½æ•°æ³•è®¾è®¡FIRæ•°å­—æ»¤æ³¢å™¨</h2>
        
        <div class="window-box">
            <h3>ğŸŸ£ åŸºæœ¬è®¾è®¡æ€æƒ³</h3>
            <p>çª—å‡½æ•°æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼šä»<strong>ç†æƒ³æ»¤æ³¢å™¨çš„å†²æ¿€å“åº”</strong>å‡ºå‘ï¼Œé€šè¿‡<strong>çª—å‡½æ•°åŠ æƒæˆªæ–­</strong>å¾—åˆ°æœ‰é™é•¿åº¦çš„FIRæ»¤æ³¢å™¨ã€‚</p>
            
            <h4>è®¾è®¡æ­¥éª¤</h4>
            <div class="design-steps">
                <ol>
                    <li><strong>ç¡®å®šç†æƒ³å“åº”</strong>ï¼šæ ¹æ®æŠ€æœ¯æŒ‡æ ‡ç¡®å®šç†æƒ³æ»¤æ³¢å™¨H_d(e^{jÏ‰})</li>
                    <li><strong>æ±‚ç†æƒ³å†²æ¿€å“åº”</strong>ï¼šé€šè¿‡IDTFTå¾—åˆ°h_d[n]</li>
                    <li><strong>é€‰æ‹©çª—å‡½æ•°</strong>ï¼šæ ¹æ®æŠ€æœ¯è¦æ±‚é€‰æ‹©åˆé€‚çš„çª—å‡½æ•°w[n]</li>
                    <li><strong>æˆªæ–­åŠ æƒ</strong>ï¼šh[n] = h_d[n] Â· w[n]</li>
                    <li><strong>éªŒè¯æ€§èƒ½</strong>ï¼šæ£€æŸ¥è®¾è®¡ç»“æœæ˜¯å¦æ»¡è¶³æŒ‡æ ‡</li>
                </ol>
            </div>
        </div>
        
        <div class="knowledge-point">
            <h3>ç†æƒ³æ»¤æ³¢å™¨çš„å†²æ¿€å“åº”</h3>
            
            <h4>ç†æƒ³ä½é€šæ»¤æ³¢å™¨</h4>
            <div class="formula">
                h_d[n] = (sin(Ï‰_c n))/(Ï€n), n â‰  0<br>
                h_d[0] = Ï‰_c/Ï€
            </div>
            <p>å…¶ä¸­Ï‰_cä¸ºæˆªæ­¢é¢‘ç‡ã€‚</p>
            
            <h4>å…¶ä»–ç±»å‹æ»¤æ³¢å™¨</h4>
            <div class="example">
                <ul>
                    <li><strong>é«˜é€š</strong>ï¼šh_d[n] = Î´[n] - h_{lp}[n]</li>
                    <li><strong>å¸¦é€š</strong>ï¼šh_d[n] = h_{lp1}[n] - h_{lp2}[n]</li>
                    <li><strong>å¸¦é˜»</strong>ï¼šh_d[n] = Î´[n] - h_{bp}[n]</li>
                </ul>
            </div>
        </div>
        
        <div class="knowledge-point">
            <h3>å¸¸ç”¨çª—å‡½æ•°åŠå…¶ç‰¹æ€§</h3>
            
            <div class="window-types">
                <div class="window-item">
                    <h4>çŸ©å½¢çª—</h4>
                    <div class="formula">w[n] = 1, 0 â‰¤ n â‰¤ N-1</div>
                    <p><strong>ä¸»ç“£å®½åº¦</strong>ï¼š4Ï€/N</p>
                    <p><strong>æ—ç“£è¡°å‡</strong>ï¼š-13dB</p>
                    <p><strong>ç‰¹ç‚¹</strong>ï¼šè¿‡æ¸¡å¸¦çª„ï¼Œé˜»å¸¦è¡°å‡å°</p>
                </div>
                
                <div class="window-item">
                    <h4>æ±‰å®çª—</h4>
                    <div class="formula">w[n] = 0.5[1 - cos(2Ï€n/(N-1))]</div>
                    <p><strong>ä¸»ç“£å®½åº¦</strong>ï¼š8Ï€/N</p>
                    <p><strong>æ—ç“£è¡°å‡</strong>ï¼š-31dB</p>
                    <p><strong>ç‰¹ç‚¹</strong>ï¼šæ—ç“£è¡°å‡å¿«</p>
                </div>
                
                <div class="window-item">
                    <h4>æµ·æ˜çª—</h4>
                    <div class="formula">w[n] = 0.54 - 0.46cos(2Ï€n/(N-1))</div>
                    <p><strong>ä¸»ç“£å®½åº¦</strong>ï¼š8Ï€/N</p>
                    <p><strong>æ—ç“£è¡°å‡</strong>ï¼š-41dB</p>
                    <p><strong>ç‰¹ç‚¹</strong>ï¼šç»¼åˆæ€§èƒ½å¥½</p>
                </div>
                
                <div class="window-item">
                    <h4>å¸ƒæ‹‰å…‹æ›¼çª—</h4>
                    <div class="formula">w[n] = 0.42 - 0.5cos(2Ï€n/(N-1)) + 0.08cos(4Ï€n/(N-1))</div>
                    <p><strong>ä¸»ç“£å®½åº¦</strong>ï¼š12Ï€/N</p>
                    <p><strong>æ—ç“£è¡°å‡</strong>ï¼š-57dB</p>
                    <p><strong>ç‰¹ç‚¹</strong>ï¼šé˜»å¸¦è¡°å‡å¤§</p>
                </div>
                
                <div class="window-item">
                    <h4>å‡¯æ³½çª—</h4>
                    <div class="formula">w[n] = I_0(Î²âˆš(1-((n-(N-1)/2)/((N-1)/2))^2))/I_0(Î²)</div>
                    <p><strong>å‚æ•°</strong>ï¼šÎ²å¯è°ƒ</p>
                    <p><strong>ç‰¹ç‚¹</strong>ï¼šæœ€ä¼˜åŒ–çª—å‡½æ•°</p>
                    <p><strong>ä¼˜åŠ¿</strong>ï¼šå¯è°ƒèŠ‚è¿‡æ¸¡å¸¦å’Œé˜»å¸¦è¡°å‡</p>
                </div>
                
                <div class="window-item">
                    <h4>åˆ‡æ¯”é›ªå¤«çª—</h4>
                    <div class="formula">åŸºäºåˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼</div>
                    <p><strong>å‚æ•°</strong>ï¼šé˜»å¸¦è¡°å‡å¯æŒ‡å®š</p>
                    <p><strong>ç‰¹ç‚¹</strong>ï¼šç­‰çº¹æ³¢ç‰¹æ€§</p>
                    <p><strong>ä¼˜åŠ¿</strong>ï¼šåœ¨ç»™å®šé•¿åº¦ä¸‹é˜»å¸¦è¡°å‡æœ€å¤§</p>
                </div>
            </div>
        </div>
        
        <div class="important">
            <h3>âš–ï¸ çª—å‡½æ•°é€‰æ‹©å‡†åˆ™</h3>
            <div class="comparison-grid">
                <div class="comparison-item">
                    <h4>æ€§èƒ½æƒè¡¡</h4>
                    <ul>
                        <li><strong>è¿‡æ¸¡å¸¦å®½åº¦</strong> âˆ ä¸»ç“£å®½åº¦</li>
                        <li><strong>é˜»å¸¦è¡°å‡</strong> âˆ æ—ç“£è¡°å‡</li>
                        <li><strong>æ»¤æ³¢å™¨é•¿åº¦</strong> âˆ æ€§èƒ½è¦æ±‚</li>
                    </ul>
                </div>
                <div class="comparison-item">
                    <h4>é€‰æ‹©å»ºè®®</h4>
                    <ul>
                        <li><strong>çŸ©å½¢çª—</strong>ï¼šè¿‡æ¸¡å¸¦è¦æ±‚ä¸¥æ ¼</li>
                        <li><strong>æ±‰å®/æµ·æ˜çª—</strong>ï¼šä¸€èˆ¬åº”ç”¨</li>
                        <li><strong>å‡¯æ³½çª—</strong>ï¼šæœ€ä¼˜è®¾è®¡</li>
                        <li><strong>åˆ‡æ¯”é›ªå¤«çª—</strong>ï¼šé˜»å¸¦è¡°å‡ä¸¥æ ¼</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="plot-container">
            <h3>çª—å‡½æ•°æ³•è®¾è®¡æ¼”ç¤º</h3>
            <canvas id="windowMethodDemo" width="800" height="500"></canvas>
            <div class="controls">
                <label>çª—å‡½æ•°ç±»å‹ï¼š</label>
                <select id="windowType">
                    <option value="rectangular">çŸ©å½¢çª—</option>
                    <option value="hanning">æ±‰å®çª—</option>
                    <option value="hamming">æµ·æ˜çª—</option>
                    <option value="blackman">å¸ƒæ‹‰å…‹æ›¼çª—</option>
                    <option value="kaiser">å‡¯æ³½çª—</option>
                </select>
                <label>æ»¤æ³¢å™¨é•¿åº¦ï¼š</label>
                <input type="range" id="windowLength" min="11" max="101" step="10" value="31">
                <span id="windowLengthValue">31</span>
                <label>æˆªæ­¢é¢‘ç‡ï¼š</label>
                <input type="range" id="cutoffFreq" min="0.1" max="0.9" step="0.1" value="0.3">
                <span id="cutoffValue">0.3</span>Ï€
                <label>Î²å‚æ•°(å‡¯æ³½çª—)ï¼š</label>
                <input type="range" id="kaiserBeta" min="1" max="10" step="0.5" value="5">
                <span id="betaValue">5</span>
                <button onclick="updateWindowMethod()">æ›´æ–°è®¾è®¡</button>
            </div>
        </div>
        
        <h2>3. é¢‘ç‡æŠ½æ ·æ³•è®¾è®¡FIRæ•°å­—æ»¤æ³¢å™¨</h2>
        
        <div class="sampling-box">
            <h3>ğŸ”µ åŸºæœ¬åŸç†</h3>
            <p>é¢‘ç‡æŠ½æ ·æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼šåœ¨<strong>é¢‘ç‡åŸŸå¯¹ç†æƒ³å“åº”è¿›è¡Œç­‰é—´éš”æŠ½æ ·</strong>ï¼Œç„¶åé€šè¿‡IDFTå¾—åˆ°æ—¶åŸŸå†²æ¿€å“åº”ã€‚</p>
            
            <h4>è®¾è®¡å…¬å¼</h4>
            <div class="formula">
                H[k] = H_d(e^{j2Ï€k/N}), k = 0, 1, ..., N-1<br>
                h[n] = (1/N) âˆ‘(k=0 to N-1) H[k]e^{j2Ï€kn/N}
            </div>
        </div>
        
        <div class="knowledge-point">
            <h3>è®¾è®¡æ­¥éª¤ä¸ç‰¹ç‚¹</h3>
            
            <div class="design-steps">
                <h4>ğŸ”§ å…·ä½“è®¾è®¡æ­¥éª¤</h4>
                <ol>
                    <li><strong>ç¡®å®šæ»¤æ³¢å™¨é•¿åº¦N</strong>ï¼šæ ¹æ®æŠ€æœ¯æŒ‡æ ‡é€‰æ‹©</li>
                    <li><strong>é¢‘ç‡æŠ½æ ·</strong>ï¼šåœ¨Ï‰ = 2Ï€k/Nå¤„å¯¹ç†æƒ³å“åº”æŠ½æ ·</li>
                    <li><strong>è¿‡æ¸¡å¸¦å¤„ç†</strong>ï¼šå¯¹è¿‡æ¸¡å¸¦æŠ½æ ·ç‚¹è¿›è¡Œä¼˜åŒ–</li>
                    <li><strong>IDFTè®¡ç®—</strong>ï¼šæ±‚å¾—h[n]</li>
                    <li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè°ƒæ•´è¿‡æ¸¡å¸¦æŠ½æ ·å€¼</li>
                </ol>
            </div>
            
            <div class="example">
                <h4>é¢‘ç‡æŠ½æ ·çš„ç‰¹ç‚¹</h4>
                <ul>
                    <li><strong>ç²¾ç¡®åŒ¹é…</strong>ï¼šåœ¨æŠ½æ ·ç‚¹å¤„é¢‘ç‡å“åº”å®Œå…¨åŒ¹é…ç†æƒ³å€¼</li>
                    <li><strong>è¿‡æ¸¡å¸¦æ§åˆ¶</strong>ï¼šå¯é€šè¿‡ä¼˜åŒ–è¿‡æ¸¡å¸¦æŠ½æ ·å€¼æ”¹å–„æ€§èƒ½</li>
                    <li><strong>è®¡ç®—ç®€ä¾¿</strong>ï¼šç›´æ¥ä½¿ç”¨DFT/FFTç®—æ³•</li>
                    <li><strong>è®¾è®¡çµæ´»</strong>ï¼šå¯ä»»æ„æŒ‡å®šé¢‘ç‡å“åº”å½¢çŠ¶</li>
                </ul>
            </div>
        </div>
        
        <div class="knowledge-point">
            <h3>è¿‡æ¸¡å¸¦ä¼˜åŒ–</h3>
            <p>åœ¨è¿‡æ¸¡å¸¦åŒºåŸŸï¼Œå¯ä»¥é€šè¿‡ä¼˜åŒ–æŠ½æ ·å€¼æ¥æ”¹å–„æ»¤æ³¢å™¨æ€§èƒ½ï¼š</p>
            
            <h4>ä¼˜åŒ–ç›®æ ‡</h4>
            <div class="formula">
                min{max|H(e^{jÏ‰}) - H_d(e^{jÏ‰})|} for Ï‰ âˆˆ è¿‡æ¸¡å¸¦
            </div>
            
            <div class="frequency-sampling-grid">
                <div class="comparison-item">
                    <h4>ä¼ ç»Ÿæ–¹æ³•</h4>
                    <ul>
                        <li>è¿‡æ¸¡å¸¦æŠ½æ ·å€¼è®¾ä¸º0.5</li>
                        <li>ç®€å•ä½†éæœ€ä¼˜</li>
                        <li>å¯èƒ½å‡ºç°è¾ƒå¤§çº¹æ³¢</li>
                    </ul>
                </div>
                <div class="comparison-item">
                    <h4>ä¼˜åŒ–æ–¹æ³•</h4>
                    <ul>
                        <li>ä½¿ç”¨çº¿æ€§è§„åˆ’æˆ–æ¢¯åº¦ç®—æ³•</li>
                        <li>æœ€å°åŒ–æœ€å¤§è¯¯å·®</li>
                        <li>è·å¾—æ›´å¥½çš„é˜»å¸¦è¡°å‡</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="plot-container">
            <h3>é¢‘ç‡æŠ½æ ·æ³•è®¾è®¡æ¼”ç¤º</h3>
            <canvas id="frequencySamplingDemo" width="800" height="500"></canvas>
            <div class="controls">
                <label>æ»¤æ³¢å™¨é•¿åº¦Nï¼š</label>
                <input type="range" id="samplingLength" min="16" max="64" step="8" value="32">
                <span id="samplingLengthValue">32</span>
                <label>é€šå¸¦æˆªæ­¢ï¼š</label>
                <input type="range" id="passband" min="0.1" max="0.4" step="0.05" value="0.2">
                <span id="passbandValue">0.2</span>Ï€
                <label>é˜»å¸¦èµ·å§‹ï¼š</label>
                <input type="range" id="stopband" min="0.4" max="0.8" step="0.05" value="0.6">
                <span id="stopbandValue">0.6</span>Ï€
                <label>è¿‡æ¸¡å¸¦ä¼˜åŒ–ï¼š</label>
                <select id="transitionOpt">
                    <option value="simple">ç®€å•æ–¹æ³•(0.5)</option>
                    <option value="optimized">ä¼˜åŒ–æ–¹æ³•</option>
                </select>
                <button onclick="updateFrequencySampling()">æ›´æ–°è®¾è®¡</button>
            </div>
        </div>
        
        <h2>4. IIRä¸FIRæ•°å­—æ»¤æ³¢å™¨çš„æ¯”è¾ƒ</h2>
        
        <div class="comparison-table">
            <h3>ğŸ“Š è¯¦ç»†æ€§èƒ½å¯¹æ¯”</h3>
            <table>
                <tr>
                    <th rowspan="2">æ¯”è¾ƒé¡¹ç›®</th>
                    <th>IIRæ»¤æ³¢å™¨</th>
                    <th>FIRæ»¤æ³¢å™¨</th>
                </tr>
                <tr>
                    <th>Infinite Impulse Response</th>
                    <th>Finite Impulse Response</th>
                </tr>
                <tr>
                    <td><strong>ç³»ç»Ÿå‡½æ•°</strong></td>
                    <td>H(z) = B(z)/A(z)</td>
                    <td>H(z) = B(z)</td>
                </tr>
                <tr>
                    <td><strong>å†²æ¿€å“åº”</strong></td>
                    <td>æ— é™é•¿ï¼Œé€’å‡</td>
                    <td>æœ‰é™é•¿ï¼ŒNä¸ªç‚¹</td>
                </tr>
                <tr>
                    <td><strong>ç¨³å®šæ€§</strong></td>
                    <td>å¯èƒ½ä¸ç¨³å®š</td>
                    <td>æ€»æ˜¯ç¨³å®š</td>
                </tr>
                <tr>
                    <td><strong>ç›¸ä½ç‰¹æ€§</strong></td>
                    <td>éçº¿æ€§ç›¸ä½</td>
                    <td>å¯å®ç°ä¸¥æ ¼çº¿æ€§ç›¸ä½</td>
                </tr>
                <tr>
                    <td><strong>è®¡ç®—å¤æ‚åº¦</strong></td>
                    <td>ä½ï¼ˆå°‘æ•°ä¹˜æ³•å™¨ï¼‰</td>
                    <td>é«˜ï¼ˆNä¸ªä¹˜æ³•å™¨ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>å­˜å‚¨éœ€æ±‚</strong></td>
                    <td>å°‘ï¼ˆå‡ ä¸ªå»¶è¿Ÿå•å…ƒï¼‰</td>
                    <td>å¤šï¼ˆNä¸ªå»¶è¿Ÿå•å…ƒï¼‰</td>
                </tr>
                <tr>
                    <td><strong>è®¾è®¡æ–¹æ³•</strong></td>
                    <td>æ¨¡æ‹ŸåŸå‹å˜æ¢</td>
                    <td>çª—å‡½æ•°æ³•ã€é¢‘ç‡æŠ½æ ·æ³•</td>
                </tr>
                <tr>
                    <td><strong>é¢‘ç‡é€‰æ‹©æ€§</strong></td>
                    <td>å¥½ï¼ˆé™¡å³­è¿‡æ¸¡å¸¦ï¼‰</td>
                    <td>è¾ƒå·®ï¼ˆéœ€è¦æ›´é«˜é˜¶æ•°ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>é‡åŒ–æ•æ„Ÿæ€§</strong></td>
                    <td>æ•æ„Ÿï¼ˆæç‚¹ä½ç½®ï¼‰</td>
                    <td>ä¸æ•æ„Ÿ</td>
                </tr>
                <tr>
                    <td><strong>åº”ç”¨åœºåˆ</strong></td>
                    <td>å¯¹ç›¸ä½è¦æ±‚ä¸ä¸¥æ ¼</td>
                    <td>å¯¹ç›¸ä½è¦æ±‚ä¸¥æ ¼</td>
                </tr>
            </table>
        </div>
        
        <div class="important">
            <h3>ğŸ¯ é€‰æ‹©æŒ‡å¯¼åŸåˆ™</h3>
            
            <div class="comparison-grid">
                <div class="comparison-item">
                    <h4>é€‰æ‹©IIRçš„æƒ…å†µ</h4>
                    <ul>
                        <li><strong>å®æ—¶å¤„ç†</strong>ï¼šè®¡ç®—èµ„æºæœ‰é™</li>
                        <li><strong>å­˜å‚¨å—é™</strong>ï¼šå†…å­˜ç©ºé—´ç´§å¼ </li>
                        <li><strong>é™¡å³­æ»¤æ³¢</strong>ï¼šéœ€è¦çª„è¿‡æ¸¡å¸¦</li>
                        <li><strong>ç»å…¸åº”ç”¨</strong>ï¼šéŸ³é¢‘å‡è¡¡ã€æŠ—æ··å </li>
                        <li><strong>æ¨¡æ‹Ÿå¯¹åº”</strong>ï¼šæœ‰æˆç†Ÿæ¨¡æ‹Ÿè®¾è®¡</li>
                    </ul>
                </div>
                <div class="comparison-item">
                    <h4>é€‰æ‹©FIRçš„æƒ…å†µ</h4>
                    <ul>
                        <li><strong>çº¿æ€§ç›¸ä½</strong>ï¼šæ³¢å½¢ä¿çœŸåº¦é‡è¦</li>
                        <li><strong>æ•°å­—é€šä¿¡</strong>ï¼šç¬¦å·é—´å¹²æ‰°æ•æ„Ÿ</li>
                        <li><strong>å›¾åƒå¤„ç†</strong>ï¼šç©ºé—´æ»¤æ³¢åº”ç”¨</li>
                        <li><strong>ç²¾å¯†æµ‹é‡</strong>ï¼šç³»ç»Ÿç¨³å®šæ€§å…³é”®</li>
                        <li><strong>è‡ªé€‚åº”æ»¤æ³¢</strong>ï¼šç³»æ•°éœ€è¦è°ƒæ•´</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="plot-container">
            <h3>IIR vs FIRæ€§èƒ½å¯¹æ¯”æ¼”ç¤º</h3>
            <canvas id="iirVsFirDemo" width="800" height="400"></canvas>
            <div class="controls">
                <label>æ»¤æ³¢å™¨æŒ‡æ ‡ï¼š</label>
                <select id="filterSpec">
                    <option value="lowpass">ä½é€šæ»¤æ³¢å™¨</option>
                    <option value="bandpass">å¸¦é€šæ»¤æ³¢å™¨</option>
                </select>
                <label>é€šå¸¦çº¹æ³¢ï¼š</label>
                <input type="range" id="ripple" min="0.1" max="3" step="0.1" value="1">
                <span id="rippleValue">1</span> dB
                <label>é˜»å¸¦è¡°å‡ï¼š</label>
                <input type="range" id="stopAtten" min="20" max="60" step="5" value="40">
                <span id="stopAttenValue">40</span> dB
                <button onclick="updateComparison()">æ›´æ–°å¯¹æ¯”</button>
            </div>
            <div id="comparisonResults" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px;"></div>
        </div>
        
        <h2>ç»ƒä¹ é¢˜ç›®</h2>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 1ï¼šçº¿æ€§ç›¸ä½åˆ¤æ–­</h4>
            <p>ç»™å®šFIRæ»¤æ³¢å™¨çš„å†²æ¿€å“åº”ï¼šh[n] = [1, 2, 3, 2, 1]ï¼Œåˆ¤æ–­ï¼š</p>
            <ol>
                <li>è¯¥æ»¤æ³¢å™¨æ˜¯å¦å…·æœ‰çº¿æ€§ç›¸ä½ï¼Ÿ</li>
                <li>å±äºå“ªä¸€ç±»çº¿æ€§ç›¸ä½ï¼Ÿ</li>
                <li>è®¡ç®—ç¾¤å»¶è¿Ÿã€‚</li>
            </ol>
            <button class="show-answer" onclick="toggleAnswer('answer1')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer1" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                1. å…·æœ‰çº¿æ€§ç›¸ä½ï¼Œå› ä¸ºh[n] = h[4-n]ï¼ˆå¶å¯¹ç§°ï¼‰<br>
                2. ç¬¬ä¸€ç±»çº¿æ€§ç›¸ä½ï¼ˆN=5ä¸ºå¥‡æ•°ï¼Œå¶å¯¹ç§°ï¼‰<br>
                3. ç¾¤å»¶è¿Ÿ Ï„_g = (N-1)/2 = (5-1)/2 = 2ä¸ªé‡‡æ ·å‘¨æœŸ
            </div>
        </div>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 2ï¼šçª—å‡½æ•°æ³•è®¾è®¡</h4>
            <p>ç”¨çª—å‡½æ•°æ³•è®¾è®¡ä½é€šFIRæ»¤æ³¢å™¨ï¼Œè¦æ±‚ï¼š</p>
            <ul>
                <li>æˆªæ­¢é¢‘ç‡ï¼šÏ‰_c = 0.4Ï€</li>
                <li>é•¿åº¦ï¼šN = 11</li>
                <li>ä½¿ç”¨æµ·æ˜çª—</li>
            </ul>
            <p>æ±‚æ»¤æ³¢å™¨ç³»æ•°h[n]ã€‚</p>
            <button class="show-answer" onclick="toggleAnswer('answer2')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer2" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                1. ç†æƒ³å†²æ¿€å“åº”ï¼šh_d[n] = 0.4sin(0.4Ï€(n-5))/Ï€(n-5)ï¼Œnâ‰ 5ï¼›h_d[5] = 0.4<br>
                2. æµ·æ˜çª—ï¼šw[n] = 0.54 - 0.46cos(2Ï€n/10)ï¼Œn = 0,1,...,10<br>
                3. h[n] = h_d[n] Ã— w[n]<br>
                4. è®¡ç®—å¾—åˆ°11ä¸ªç³»æ•°ï¼Œå…³äºn=5ç‚¹å¯¹ç§°
            </div>
        </div>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 3ï¼šé¢‘ç‡æŠ½æ ·æ³•è®¾è®¡</h4>
            <p>ç”¨é¢‘ç‡æŠ½æ ·æ³•è®¾è®¡N=8çš„ä½é€šFIRæ»¤æ³¢å™¨ï¼Œç†æƒ³é¢‘ç‡å“åº”ï¼š</p>
            <ul>
                <li>H_d[0] = H_d[1] = 1</li>
                <li>H_d[2] = H_d[3] = 0.5ï¼ˆè¿‡æ¸¡å¸¦ï¼‰</li>
                <li>H_d[4] = H_d[5] = H_d[6] = H_d[7] = 0</li>
            </ul>
            <p>æ±‚h[n]çš„è¡¨è¾¾å¼ã€‚</p>
            <button class="show-answer" onclick="toggleAnswer('answer3')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer3" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                ä½¿ç”¨IDFTå…¬å¼ï¼šh[n] = (1/8)âˆ‘(k=0åˆ°7) H[k]e^{j2Ï€kn/8}<br>
                = (1/8)[1Ã—1 + 1Ã—e^{jÏ€n/4} + 0.5Ã—e^{jÏ€n/2} + 0.5Ã—e^{j3Ï€n/4}]<br>
                åŒ–ç®€åå¾—åˆ°å®æ•°åºåˆ—ï¼ˆéœ€è¦ä¿è¯çº¿æ€§ç›¸ä½å¯¹ç§°æ€§ï¼‰
            </div>
        </div>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 4ï¼šæ»¤æ³¢å™¨é€‰æ‹©</h4>
            <p>å¯¹äºä»¥ä¸‹åº”ç”¨åœºæ™¯ï¼Œåº”è¯¥é€‰æ‹©IIRè¿˜æ˜¯FIRæ»¤æ³¢å™¨ï¼Ÿè¯´æ˜ç†ç”±ã€‚</p>
            <ol>
                <li>æ•°å­—éŸ³é¢‘å‡è¡¡å™¨</li>
                <li>å›¾åƒè¾¹ç¼˜æ£€æµ‹æ»¤æ³¢å™¨</li>
                <li>å¿ƒç”µä¿¡å·çš„50Hzé™·æ³¢å™¨</li>
                <li>æ•°å­—é€šä¿¡ç³»ç»Ÿä¸­çš„è„‰å†²æˆå½¢æ»¤æ³¢å™¨</li>
            </ol>
            <button class="show-answer" onclick="toggleAnswer('answer4')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer4" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                1. IIR - å¯¹ç›¸ä½è¦æ±‚ä¸ä¸¥æ ¼ï¼Œéœ€è¦é™¡å³­çš„é¢‘ç‡é€‰æ‹©æ€§<br>
                2. FIR - éœ€è¦çº¿æ€§ç›¸ä½ä¿æŒå›¾åƒç»†èŠ‚ï¼Œé¿å…ç›¸ä½å¤±çœŸ<br>
                3. IIR - çª„å¸¦é™·æ³¢å™¨ç”¨IIRå®ç°æ›´ç»æµé«˜æ•ˆ<br>
                4. FIR - é€šä¿¡ç³»ç»Ÿå¯¹çº¿æ€§ç›¸ä½è¦æ±‚ä¸¥æ ¼ï¼Œé¿å…ç¬¦å·é—´å¹²æ‰°
            </div>
        </div>
        
        <div class="exercise">
            <h4>ç»ƒä¹ 5ï¼šçª—å‡½æ•°æ€§èƒ½åˆ†æ</h4>
            <p>æ¯”è¾ƒçŸ©å½¢çª—ã€æ±‰å®çª—ã€å¸ƒæ‹‰å…‹æ›¼çª—è®¾è®¡åŒä¸€è§„æ ¼ä½é€šæ»¤æ³¢å™¨çš„æ€§èƒ½ï¼š</p>
            <ul>
                <li>æˆªæ­¢é¢‘ç‡ï¼šÏ‰_c = 0.25Ï€</li>
                <li>é•¿åº¦ï¼šN = 21</li>
            </ul>
            <p>åˆ†æå„çª—å‡½æ•°çš„è¿‡æ¸¡å¸¦å®½åº¦å’Œé˜»å¸¦è¡°å‡ã€‚</p>
            <button class="show-answer" onclick="toggleAnswer('answer5')">æ˜¾ç¤ºç­”æ¡ˆ</button>
            <div id="answer5" class="answer">
                <strong>ç­”æ¡ˆï¼š</strong><br>
                <table style="width:100%; border-collapse: collapse;">
                <tr><th>çª—å‡½æ•°</th><th>è¿‡æ¸¡å¸¦å®½åº¦</th><th>é˜»å¸¦è¡°å‡</th><th>ç‰¹ç‚¹</th></tr>
                <tr><td>çŸ©å½¢çª—</td><td>4Ï€/21â‰ˆ0.6Ï€</td><td>-13dB</td><td>çª„è¿‡æ¸¡å¸¦ï¼Œä½è¡°å‡</td></tr>
                <tr><td>æ±‰å®çª—</td><td>8Ï€/21â‰ˆ1.2Ï€</td><td>-31dB</td><td>ä¸­ç­‰æ€§èƒ½</td></tr>
                <tr><td>å¸ƒæ‹‰å…‹æ›¼çª—</td><td>12Ï€/21â‰ˆ1.8Ï€</td><td>-57dB</td><td>å®½è¿‡æ¸¡å¸¦ï¼Œé«˜è¡°å‡</td></tr>
                </table>
            </div>
        </div>
        
        <h2>å­¦ä¹ è¦ç‚¹æ€»ç»“</h2>
        
        <div class="important">
            <h3>ğŸ¯ æ ¸å¿ƒæŒæ¡è¦ç‚¹</h3>
            <ol>
                <li><strong>çº¿æ€§ç›¸ä½</strong>ï¼šFIRæ»¤æ³¢å™¨çš„ç‹¬ç‰¹ä¼˜åŠ¿ï¼Œç†è§£å¯¹ç§°æ€§æ¡ä»¶</li>
                <li><strong>çª—å‡½æ•°æ³•</strong>ï¼šæœ€å¸¸ç”¨çš„è®¾è®¡æ–¹æ³•ï¼ŒæŒæ¡å„ç§çª—å‡½æ•°ç‰¹æ€§</li>
                <li><strong>é¢‘ç‡æŠ½æ ·æ³•</strong>ï¼šé¢‘åŸŸè®¾è®¡æ€è·¯ï¼Œç†è§£è¿‡æ¸¡å¸¦ä¼˜åŒ–</li>
                <li><strong>IIR vs FIR</strong>ï¼šæ ¹æ®åº”ç”¨éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ»¤æ³¢å™¨ç±»å‹</li>
                <li><strong>è®¾è®¡æƒè¡¡</strong>ï¼šè¿‡æ¸¡å¸¦ã€é˜»å¸¦è¡°å‡ã€æ»¤æ³¢å™¨é•¿åº¦çš„å…³ç³»</li>
                <li><strong>å®ç°è€ƒè™‘</strong>ï¼šè®¡ç®—å¤æ‚åº¦ã€å­˜å‚¨éœ€æ±‚ã€é‡åŒ–æ•ˆåº”</li>
            </ol>
        </div>
        
        <div class="fir-box">
            <h3>ğŸ”— å®ç”¨è®¾è®¡å»ºè®®</h3>
            <ul>
                <li><strong>åº”ç”¨å¯¼å‘</strong>ï¼šæ ¹æ®å…·ä½“åº”ç”¨é€‰æ‹©è®¾è®¡æ–¹æ³•å’Œå‚æ•°</li>
                <li><strong>çª—å‡½æ•°é€‰æ‹©</strong>ï¼šå‡¯æ³½çª—é€šå¸¸æ˜¯æœ€ä¼˜é€‰æ‹©</li>
                <li><strong>é•¿åº¦ä¼°è®¡</strong>ï¼šå¯ç”¨ç»éªŒå…¬å¼ä¼°ç®—æ‰€éœ€æ»¤æ³¢å™¨é•¿åº¦</li>
                <li><strong>æ€§èƒ½éªŒè¯</strong>ï¼šè®¾è®¡åå¿…é¡»éªŒè¯é¢‘ç‡å“åº”æ˜¯å¦æ»¡è¶³æŒ‡æ ‡</li>
                <li><strong>é‡åŒ–è€ƒè™‘</strong>ï¼šæœ‰é™å­—é•¿å®ç°æ—¶è€ƒè™‘ç³»æ•°é‡åŒ–æ•ˆåº”</li>
            </ul>
        </div>
    </div>

    <script>
        // æ›´æ–°çº¿æ€§ç›¸ä½æ¼”ç¤º
        function updateLinearPhase() {
            const canvas = document.getElementById('linearPhaseDemo');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const N = parseInt(document.getElementById('filterLength').value);
            const symmetry = document.getElementById('symmetryType').value;
            
            document.getElementById('lengthValue').textContent = N;
            
            ctx.clearRect(0, 0, width, height);
            
            drawLinearPhaseAnalysis(ctx, width, height, N, symmetry);
        }
        
        function drawLinearPhaseAnalysis(ctx, width, height, N, symmetry) {
            const subHeight = height / 2;
            
            // ä¸ŠåŠéƒ¨åˆ†ï¼šå†²æ¿€å“åº”
            drawImpulseResponse(ctx, 0, 0, width, subHeight, N, symmetry);
            
            // ä¸‹åŠéƒ¨åˆ†ï¼šé¢‘ç‡å“åº”
            drawFrequencyResponse(ctx, 0, subHeight, width, subHeight, N, symmetry);
        }
        
        function drawImpulseResponse(ctx, offsetX, offsetY, width, height, N, symmetry) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / N;
            const scaleY = height * 0.4;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç»˜åˆ¶å†²æ¿€å“åº”
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 2;
            ctx.fillStyle = '#e74c3c';
            
            for (let n = 0; n < N; n++) {
                const x = 30 + n * scaleX + scaleX/2;
                let h_n;
                
                if (symmetry === 'even') {
                    // å¶å¯¹ç§°ï¼šh[n] = h[N-1-n]
                    const center = (N-1)/2;
                    h_n = 0.5 * Math.exp(-Math.pow((n - center)/3, 2));
                } else {
                    // å¥‡å¯¹ç§°ï¼šh[n] = -h[N-1-n]
                    const center = (N-1)/2;
                    h_n = (n - center) * 0.3 * Math.exp(-Math.pow((n - center)/3, 2));
                }
                
                const y = centerY - h_n * scaleY;
                
                // ç»˜åˆ¶å†²æ¿€
                ctx.beginPath();
                ctx.moveTo(x, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                // ç»˜åˆ¶å†²æ¿€é¡¶ç‚¹
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // æ ‡é¢˜
            ctx.fillStyle = '#e74c3c';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`å†²æ¿€å“åº” h[n] (${symmetry === 'even' ? 'å¶å¯¹ç§°' : 'å¥‡å¯¹ç§°'})`, width/2, offsetY + 15);
            
            // æ˜¾ç¤ºå¯¹ç§°æ€§
            const center = (N-1)/2;
            ctx.strokeStyle = '#2ecc71';
            ctx.setLineDash([5, 5]);
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(30 + center * scaleX + scaleX/2, offsetY + 30);
            ctx.lineTo(30 + center * scaleX + scaleX/2, centerY - 10);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#2ecc71';
            ctx.font = '10px Arial';
            ctx.fillText('å¯¹ç§°è½´', 30 + center * scaleX + scaleX/2, offsetY + 25);
        }
        
        function drawFrequencyResponse(ctx, offsetX, offsetY, width, height, N, symmetry) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / Math.PI;
            const scaleY = height * 0.5;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç»˜åˆ¶å¹…åº¦å“åº”
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i <= 200; i++) {
                const omega = (i / 200) * Math.PI;
                const x = 30 + omega * scaleX;
                
                // è®¡ç®—é¢‘ç‡å“åº”
                let magnitude = calculateFIRResponse(omega, N, symmetry);
                
                const y = centerY - magnitude * scaleY;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // ç»˜åˆ¶ç›¸ä½å“åº”ï¼ˆçº¿æ€§ï¼‰
            ctx.strokeStyle = '#f39c12';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const groupDelay = (N-1)/2;
            const phaseSlope = symmetry === 'even' ? groupDelay : groupDelay + 0.5;
            
            for (let i = 0; i <= 200; i++) {
                const omega = (i / 200) * Math.PI;
                const x = 30 + omega * scaleX;
                const phase = -phaseSlope * omega;
                const normalizedPhase = phase / Math.PI; // å½’ä¸€åŒ–åˆ°[-1,1]
                
                const y = centerY - normalizedPhase * scaleY * 0.3;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // æ ‡é¢˜
            ctx.fillStyle = '#3498db';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('é¢‘ç‡å“åº”', width/2, offsetY + 15);
            
            // å›¾ä¾‹
            ctx.fillStyle = '#3498db';
            ctx.fillRect(width - 200, offsetY + 30, 20, 3);
            ctx.fillStyle = '#333';
            ctx.font = '10px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('å¹…åº¦å“åº”', width - 175, offsetY + 35);
            
            ctx.fillStyle = '#f39c12';
            ctx.fillRect(width - 200, offsetY + 50, 20, 2);
            ctx.fillText('ç›¸ä½å“åº”', width - 175, offsetY + 55);
            
            // ç¾¤å»¶è¿Ÿä¿¡æ¯
            ctx.fillStyle = '#2ecc71';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`ç¾¤å»¶è¿Ÿ: ${groupDelay} ä¸ªé‡‡æ ·å‘¨æœŸ`, width/2, offsetY + height - 10);
        }
        
        function calculateFIRResponse(omega, N, symmetry) {
            // ç®€åŒ–çš„FIRé¢‘ç‡å“åº”è®¡ç®—
            let magnitude = 0;
            
            for (let n = 0; n < N; n++) {
                let h_n;
                const center = (N-1)/2;
                
                if (symmetry === 'even') {
                    h_n = 0.5 * Math.exp(-Math.pow((n - center)/3, 2));
                } else {
                    h_n = (n - center) * 0.3 * Math.exp(-Math.pow((n - center)/3, 2));
                }
                
                magnitude += h_n * Math.cos(omega * n);
            }
            
            return Math.abs(magnitude);
        }
        
        // æ›´æ–°çª—å‡½æ•°æ³•æ¼”ç¤º
        function updateWindowMethod() {
            const canvas = document.getElementById('windowMethodDemo');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const windowType = document.getElementById('windowType').value;
            const N = parseInt(document.getElementById('windowLength').value);
            const cutoff = parseFloat(document.getElementById('cutoffFreq').value);
            const beta = parseFloat(document.getElementById('kaiserBeta').value);
            
            document.getElementById('windowLengthValue').textContent = N;
            document.getElementById('cutoffValue').textContent = cutoff.toFixed(1);
            document.getElementById('betaValue').textContent = beta;
            
            ctx.clearRect(0, 0, width, height);
            
            drawWindowMethodDemo(ctx, width, height, windowType, N, cutoff, beta);
        }
        
        function drawWindowMethodDemo(ctx, width, height, windowType, N, cutoff, beta) {
            const subHeight = height / 3;
            
            // ä¸Šï¼šç†æƒ³å“åº”
            drawIdealResponse(ctx, 0, 0, width, subHeight, cutoff);
            
            // ä¸­ï¼šçª—å‡½æ•°
            drawWindowFunction(ctx, 0, subHeight, width, subHeight, windowType, N, beta);
            
            // ä¸‹ï¼šè®¾è®¡ç»“æœ
            drawWindowedFilter(ctx, 0, 2*subHeight, width, subHeight, windowType, N, cutoff, beta);
        }
        
        function drawIdealResponse(ctx, offsetX, offsetY, width, height, cutoff) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / Math.PI;
            const scaleY = height * 0.5;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç†æƒ³ä½é€šå“åº”
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 3;
            
            const cutoffX = 30 + cutoff * Math.PI * scaleX;
            
            // é€šå¸¦
            ctx.beginPath();
            ctx.moveTo(30, centerY - scaleY);
            ctx.lineTo(cutoffX, centerY - scaleY);
            ctx.stroke();
            
            // é˜»å¸¦
            ctx.beginPath();
            ctx.moveTo(cutoffX, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            // å‚ç›´è¿‡æ¸¡
            ctx.setLineDash([3, 3]);
            ctx.beginPath();
            ctx.moveTo(cutoffX, centerY - scaleY);
            ctx.lineTo(cutoffX, centerY);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // æ ‡é¢˜
            ctx.fillStyle = '#e74c3c';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ç†æƒ³ä½é€šæ»¤æ³¢å™¨å“åº”', width/2, offsetY + 15);
        }
        
        function drawWindowFunction(ctx, offsetX, offsetY, width, height, windowType, N, beta) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / N;
            const scaleY = height * 0.5;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç»˜åˆ¶çª—å‡½æ•°
            ctx.strokeStyle = '#9c27b0';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i <= 100; i++) {
                const n = (i / 100) * (N - 1);
                const x = 30 + n * scaleX;
                const w_n = calculateWindow(n, N, windowType, beta);
                const y = centerY - w_n * scaleY;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // æ ‡é¢˜
            ctx.fillStyle = '#9c27b0';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`${getWindowName(windowType)}çª—å‡½æ•°`, width/2, offsetY + 15);
        }
        
        function drawWindowedFilter(ctx, offsetX, offsetY, width, height, windowType, N, cutoff, beta) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / Math.PI;
            const scaleY = height * 0.5;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç»˜åˆ¶è®¾è®¡çš„æ»¤æ³¢å™¨å“åº”
            ctx.strokeStyle = '#2ecc71';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i <= 200; i++) {
                const omega = (i / 200) * Math.PI;
                const x = 30 + omega * scaleX;
                const magnitude = calculateWindowedResponse(omega, windowType, N, cutoff, beta);
                const y = centerY - magnitude * scaleY;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // æ ‡é¢˜
            ctx.fillStyle = '#2ecc71';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('çª—å‡½æ•°æ³•è®¾è®¡ç»“æœ', width/2, offsetY + 15);
            
            // æ€§èƒ½æŒ‡æ ‡
            const performance = analyzeWindowPerformance(windowType, N);
            ctx.fillStyle = '#333';
            ctx.font = '10px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`è¿‡æ¸¡å¸¦å®½åº¦: ${performance.transitionWidth}`, 40, offsetY + height - 30);
            ctx.fillText(`é˜»å¸¦è¡°å‡: ${performance.stopbandAtten}`, 40, offsetY + height - 15);
        }
        
        function calculateWindow(n, N, type, beta) {
            switch (type) {
                case 'rectangular':
                    return 1;
                case 'hanning':
                    return 0.5 * (1 - Math.cos(2 * Math.PI * n / (N - 1)));
                case 'hamming':
                    return 0.54 - 0.46 * Math.cos(2 * Math.PI * n / (N - 1));
                case 'blackman':
                    return 0.42 - 0.5 * Math.cos(2 * Math.PI * n / (N - 1)) + 0.08 * Math.cos(4 * Math.PI * n / (N - 1));
                case 'kaiser':
                    const alpha = (N - 1) / 2;
                    const arg = Math.sqrt(1 - Math.pow((n - alpha) / alpha, 2));
                    return modifiedBessel0(beta * arg) / modifiedBessel0(beta);
                default:
                    return 1;
            }
        }
        
        function modifiedBessel0(x) {
            // ä¿®æ­£è´å¡å°”å‡½æ•°çš„è¿‘ä¼¼è®¡ç®—
            let sum = 1;
            let term = 1;
            for (let k = 1; k < 20; k++) {
                term *= (x / 2) / k;
                sum += term * term;
            }
            return sum;
        }
        
        function calculateWindowedResponse(omega, windowType, N, cutoff, beta) {
            // ç®€åŒ–çš„çª—å‡½æ•°æ³•æ»¤æ³¢å™¨å“åº”è®¡ç®—
            let magnitude = 0;
            
            for (let n = 0; n < N; n++) {
                const shifted_n = n - (N - 1) / 2;
                let h_ideal;
                
                if (shifted_n === 0) {
                    h_ideal = cutoff / Math.PI;
                } else {
                    h_ideal = Math.sin(cutoff * Math.PI * shifted_n) / (Math.PI * shifted_n);
                }
                
                const window_val = calculateWindow(n, N, windowType, beta);
                const h_n = h_ideal * window_val;
                
                magnitude += h_n * Math.cos(omega * shifted_n);
            }
            
            return Math.abs(magnitude);
        }
        
        function getWindowName(type) {
            const names = {
                'rectangular': 'çŸ©å½¢',
                'hanning': 'æ±‰å®',
                'hamming': 'æµ·æ˜',
                'blackman': 'å¸ƒæ‹‰å…‹æ›¼',
                'kaiser': 'å‡¯æ³½'
            };
            return names[type] || type;
        }
        
        function analyzeWindowPerformance(windowType, N) {
            const performance = {
                'rectangular': { transitionWidth: `${(4 * Math.PI / N).toFixed(2)}Ï€/${N}`, stopbandAtten: '-13dB' },
                'hanning': { transitionWidth: `${(8 * Math.PI / N).toFixed(2)}Ï€/${N}`, stopbandAtten: '-31dB' },
                'hamming': { transitionWidth: `${(8 * Math.PI / N).toFixed(2)}Ï€/${N}`, stopbandAtten: '-41dB' },
                'blackman': { transitionWidth: `${(12 * Math.PI / N).toFixed(2)}Ï€/${N}`, stopbandAtten: '-57dB' },
                'kaiser': { transitionWidth: 'å¯è°ƒ', stopbandAtten: 'å¯è°ƒ' }
            };
            
            return performance[windowType] || { transitionWidth: 'æœªçŸ¥', stopbandAtten: 'æœªçŸ¥' };
        }
        
        // æ›´æ–°é¢‘ç‡æŠ½æ ·æ³•æ¼”ç¤º
        function updateFrequencySampling() {
            const canvas = document.getElementById('frequencySamplingDemo');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const N = parseInt(document.getElementById('samplingLength').value);
            const passband = parseFloat(document.getElementById('passband').value);
            const stopband = parseFloat(document.getElementById('stopband').value);
            const optimization = document.getElementById('transitionOpt').value;
            
            document.getElementById('samplingLengthValue').textContent = N;
            document.getElementById('passbandValue').textContent = passband.toFixed(2);
            document.getElementById('stopbandValue').textContent = stopband.toFixed(2);
            
            ctx.clearRect(0, 0, width, height);
            
            drawFrequencySamplingDemo(ctx, width, height, N, passband, stopband, optimization);
        }
        
        function drawFrequencySamplingDemo(ctx, width, height, N, passband, stopband, optimization) {
            const subHeight = height / 3;
            
            // ä¸Šï¼šé¢‘ç‡æŠ½æ ·ç‚¹
            drawSamplingPoints(ctx, 0, 0, width, subHeight, N, passband, stopband, optimization);
            
            // ä¸­ï¼šå†²æ¿€å“åº”
            drawSampledImpulseResponse(ctx, 0, subHeight, width, subHeight, N, passband, stopband, optimization);
            
            // ä¸‹ï¼šé¢‘ç‡å“åº”
            drawSampledFrequencyResponse(ctx, 0, 2*subHeight, width, subHeight, N, passband, stopband, optimization);
        }
        
        function drawSamplingPoints(ctx, offsetX, offsetY, width, height, N, passband, stopband, optimization) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / Math.PI;
            const scaleY = height * 0.5;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç»˜åˆ¶æŠ½æ ·ç‚¹
            for (let k = 0; k < N; k++) {
                const omega_k = 2 * Math.PI * k / N;
                if (omega_k <= Math.PI) {  // åªç»˜åˆ¶[0, Ï€]èŒƒå›´
                    const x = 30 + omega_k * scaleX;
                    let H_k = getSampledValue(omega_k, passband, stopband, optimization);
                    const y = centerY - H_k * scaleY;
                    
                    // æŠ½æ ·ç‚¹
                    ctx.fillStyle = '#2196f3';
                    ctx.beginPath();
                    ctx.arc(x, y, 5, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    // æ ‡æ³¨
                    ctx.fillStyle = '#333';
                    ctx.font = '8px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(`H[${k}]`, x, y - 10);
                }
            }
            
            // ç†æƒ³å“åº”æ›²çº¿
            ctx.strokeStyle = '#e74c3c';
            ctx.setLineDash([3, 3]);
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let i = 0; i <= 100; i++) {
                const omega = (i / 100) * Math.PI;
                const x = 30 + omega * scaleX;
                let ideal_response;
                
                if (omega <= passband * Math.PI) {
                    ideal_response = 1;
                } else if (omega >= stopband * Math.PI) {
                    ideal_response = 0;
                } else {
                    ideal_response = 0.5; // è¿‡æ¸¡å¸¦
                }
                
                const y = centerY - ideal_response * scaleY;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            ctx.setLineDash([]);
            
            // æ ‡é¢˜
            ctx.fillStyle = '#2196f3';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`é¢‘ç‡æŠ½æ ·ç‚¹ (N=${N})`, width/2, offsetY + 15);
        }
        
        function drawSampledImpulseResponse(ctx, offsetX, offsetY, width, height, N, passband, stopband, optimization) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / N;
            const scaleY = height * 0.4;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // è®¡ç®—å¹¶ç»˜åˆ¶å†²æ¿€å“åº”
            ctx.strokeStyle = '#ff9800';
            ctx.lineWidth = 2;
            ctx.fillStyle = '#ff9800';
            
            for (let n = 0; n < N; n++) {
                const x = 30 + n * scaleX + scaleX/2;
                const h_n = calculateSampledImpulseResponse(n, N, passband, stopband, optimization);
                const y = centerY - h_n * scaleY;
                
                // ç»˜åˆ¶å†²æ¿€
                ctx.beginPath();
                ctx.moveTo(x, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                // ç»˜åˆ¶å†²æ¿€é¡¶ç‚¹
                ctx.beginPath();
                ctx.arc(x, y, 2, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // æ ‡é¢˜
            ctx.fillStyle = '#ff9800';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('è®¾è®¡çš„å†²æ¿€å“åº” h[n]', width/2, offsetY + 15);
        }
        
        function drawSampledFrequencyResponse(ctx, offsetX, offsetY, width, height, N, passband, stopband, optimization) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / Math.PI;
            const scaleY = height * 0.5;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç»˜åˆ¶é¢‘ç‡å“åº”
            ctx.strokeStyle = '#4caf50';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i <= 200; i++) {
                const omega = (i / 200) * Math.PI;
                const x = 30 + omega * scaleX;
                const magnitude = calculateSampledFrequencyResponse(omega, N, passband, stopband, optimization);
                const y = centerY - magnitude * scaleY;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // æ ‡é¢˜
            ctx.fillStyle = '#4caf50';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`é¢‘ç‡æŠ½æ ·æ³•è®¾è®¡ç»“æœ (${optimization === 'optimized' ? 'è¿‡æ¸¡å¸¦ä¼˜åŒ–' : 'ç®€å•æ–¹æ³•'})`, width/2, offsetY + 15);
        }
        
        function getSampledValue(omega, passband, stopband, optimization) {
            if (omega <= passband * Math.PI) {
                return 1;
            } else if (omega >= stopband * Math.PI) {
                return 0;
            } else {
                // è¿‡æ¸¡å¸¦
                if (optimization === 'optimized') {
                    // ç®€åŒ–çš„ä¼˜åŒ–å€¼
                    const ratio = (omega - passband * Math.PI) / ((stopband - passband) * Math.PI);
                    return 0.7 * (1 - ratio);  // ä¼˜åŒ–åçš„è¿‡æ¸¡å¸¦å€¼
                } else {
                    return 0.5;  // ç®€å•æ–¹æ³•
                }
            }
        }
        
        function calculateSampledImpulseResponse(n, N, passband, stopband, optimization) {
            // ä½¿ç”¨IDFTè®¡ç®—å†²æ¿€å“åº”
            let h_n = 0;
            
            for (let k = 0; k < N; k++) {
                const omega_k = 2 * Math.PI * k / N;
                const H_k = getSampledValue(omega_k, passband, stopband, optimization);
                h_n += H_k * Math.cos(2 * Math.PI * k * n / N) / N;
            }
            
            return h_n;
        }
        
        function calculateSampledFrequencyResponse(omega, N, passband, stopband, optimization) {
            // è®¡ç®—é¢‘ç‡å“åº”
            let magnitude = 0;
            
            for (let n = 0; n < N; n++) {
                const h_n = calculateSampledImpulseResponse(n, N, passband, stopband, optimization);
                magnitude += h_n * Math.cos(omega * n);
            }
            
            return Math.abs(magnitude);
        }
        
        // æ›´æ–°IIR vs FIRå¯¹æ¯”æ¼”ç¤º
        function updateComparison() {
            const canvas = document.getElementById('iirVsFirDemo');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const filterSpec = document.getElementById('filterSpec').value;
            const ripple = parseFloat(document.getElementById('ripple').value);
            const stopAtten = parseFloat(document.getElementById('stopAtten').value);
            
            document.getElementById('rippleValue').textContent = ripple;
            document.getElementById('stopAttenValue').textContent = stopAtten;
            
            ctx.clearRect(0, 0, width, height);
            
            drawIIRvsFIRComparison(ctx, width, height, filterSpec, ripple, stopAtten);
            updateComparisonResults(filterSpec, ripple, stopAtten);
        }
        
        function drawIIRvsFIRComparison(ctx, width, height, filterSpec, ripple, stopAtten) {
            const subHeight = height / 2;
            
            // ä¸ŠåŠéƒ¨åˆ†ï¼šIIRæ»¤æ³¢å™¨
            drawFilterComparison(ctx, 0, 0, width, subHeight, 'IIR', filterSpec, ripple, stopAtten);
            
            // ä¸‹åŠéƒ¨åˆ†ï¼šFIRæ»¤æ³¢å™¨
            drawFilterComparison(ctx, 0, subHeight, width, subHeight, 'FIR', filterSpec, ripple, stopAtten);
        }
        
        function drawFilterComparison(ctx, offsetX, offsetY, width, height, type, filterSpec, ripple, stopAtten) {
            const centerY = offsetY + height * 0.8;
            const scaleX = (width - 60) / Math.PI;
            const scaleY = height * 0.5;
            
            // åæ ‡è½´
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            
            ctx.beginPath();
            ctx.moveTo(30, centerY);
            ctx.lineTo(width - 30, centerY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(30, offsetY + 20);
            ctx.lineTo(30, centerY);
            ctx.stroke();
            
            // ç»˜åˆ¶é¢‘ç‡å“åº”
            const color = type === 'IIR' ? '#e74c3c' : '#2ecc71';
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i <= 200; i++) {
                const omega = (i / 200) * Math.PI;
                const x = 30 + omega * scaleX;
                const magnitude = calculateFilterResponse(omega, type, filterSpec, ripple, stopAtten);
                const y = centerY - magnitude * scaleY;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            
            // æ ‡é¢˜
            ctx.fillStyle = color;
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`${type}${filterSpec === 'lowpass' ? 'ä½é€š' : 'å¸¦é€š'}æ»¤æ³¢å™¨`, width/2, offsetY + 15);
            
            // æŒ‡æ ‡çº¿
            drawSpecificationLines(ctx, offsetX, offsetY, width, height, scaleX, scaleY, centerY, filterSpec, ripple, stopAtten);
        }
        
        function drawSpecificationLines(ctx, offsetX, offsetY, width, height, scaleX, scaleY, centerY, filterSpec, ripple, stopAtten) {
            ctx.strokeStyle = '#666';
            ctx.setLineDash([3, 3]);
            ctx.lineWidth = 1;
            
            if (filterSpec === 'lowpass') {
                // é€šå¸¦çº¹æ³¢çº¿
                const rippleLinear = 1 - ripple * 0.1;  // ç®€åŒ–è½¬æ¢
                ctx.beginPath();
                ctx.moveTo(30, centerY - rippleLinear * scaleY);
                ctx.lineTo(30 + 0.3 * Math.PI * scaleX, centerY - rippleLinear * scaleY);
                ctx.stroke();
                
                // é˜»å¸¦è¡°å‡çº¿
                const stopLinear = Math.pow(10, -stopAtten / 20);
                ctx.beginPath();
                ctx.moveTo(30 + 0.5 * Math.PI * scaleX, centerY - stopLinear * scaleY);
                ctx.lineTo(width - 30, centerY - stopLinear * scaleY);
                ctx.stroke();
            }
            
            ctx.setLineDash([]);
        }
        
        function calculateFilterResponse(omega, type, filterSpec, ripple, stopAtten) {
            // ç®€åŒ–çš„æ»¤æ³¢å™¨å“åº”è®¡ç®—
            let magnitude = 1;
            
            if (filterSpec === 'lowpass') {
                if (type === 'IIR') {
                    // IIRä½é€šï¼šé™¡å³­è¿‡æ¸¡
                    const order = Math.ceil(stopAtten / 6);  // ç®€åŒ–çš„é˜¶æ•°ä¼°è®¡
                    magnitude = 1 / Math.sqrt(1 + Math.pow(omega / (0.4 * Math.PI), 2 * order));
                    
                    // æ·»åŠ é€šå¸¦çº¹æ³¢
                    if (omega <= 0.3 * Math.PI) {
                        magnitude *= (1 + 0.1 * ripple * Math.sin(omega * 20));
                    }
                } else {
                    // FIRä½é€šï¼šè¾ƒç¼“è¿‡æ¸¡
                    const N = Math.ceil(stopAtten * 0.5);  // ç®€åŒ–çš„é•¿åº¦ä¼°è®¡
                    if (omega <= 0.3 * Math.PI) {
                        magnitude = 1;
                    } else if (omega >= 0.5 * Math.PI) {
                        magnitude = Math.pow(10, -stopAtten / 20);
                    } else {
                        // è¿‡æ¸¡å¸¦
                        const ratio = (omega - 0.3 * Math.PI) / (0.2 * Math.PI);
                        magnitude = (1 - ratio) + ratio * Math.pow(10, -stopAtten / 20);
                    }
                    
                    // FIRçš„çº¹æ³¢ç‰¹æ€§
                    magnitude += 0.02 * Math.sin(omega * N);
                }
            }
            
            return Math.max(0.001, Math.min(1.2, magnitude));
        }
        
        function updateComparisonResults(filterSpec, ripple, stopAtten) {
            const resultDiv = document.getElementById('comparisonResults');
            
            // ç®€åŒ–çš„è®¾è®¡ä¼°ç®—
            const iirOrder = Math.ceil(stopAtten / 6);
            const firLength = Math.ceil(stopAtten * 0.8);
            
            const iirMultipliers = iirOrder * 2;  // åˆ†å­åˆ†æ¯ç³»æ•°
            const firMultipliers = firLength;
            
            const iirMemory = iirOrder * 2;
            const firMemory = firLength;
            
            resultDiv.innerHTML = `
                <h4>è®¾è®¡å¯¹æ¯”ç»“æœ</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h5 style="color: #e74c3c;">IIRæ»¤æ³¢å™¨</h5>
                        <ul>
                            <li><strong>é˜¶æ•°ï¼š</strong>${iirOrder}</li>
                            <li><strong>ä¹˜æ³•å™¨æ•°é‡ï¼š</strong>${iirMultipliers}</li>
                            <li><strong>å­˜å‚¨å•å…ƒï¼š</strong>${iirMemory}</li>
                            <li><strong>ç›¸ä½ç‰¹æ€§ï¼š</strong>éçº¿æ€§</li>
                            <li><strong>ç¨³å®šæ€§ï¼š</strong>éœ€è¦æ£€æŸ¥</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="color: #2ecc71;">FIRæ»¤æ³¢å™¨</h5>
                        <ul>
                            <li><strong>é•¿åº¦ï¼š</strong>${firLength}</li>
                            <li><strong>ä¹˜æ³•å™¨æ•°é‡ï¼š</strong>${firMultipliers}</li>
                            <li><strong>å­˜å‚¨å•å…ƒï¼š</strong>${firMemory}</li>
                            <li><strong>ç›¸ä½ç‰¹æ€§ï¼š</strong>ä¸¥æ ¼çº¿æ€§</li>
                            <li><strong>ç¨³å®šæ€§ï¼š</strong>æ€»æ˜¯ç¨³å®š</li>
                        </ul>
                    </div>
                </div>
                <p><strong>è®¡ç®—å¤æ‚åº¦æ¯”ï¼š</strong>IIR:FIR = 1:${(firMultipliers/iirMultipliers).toFixed(1)}</p>
                <p><strong>æ¨èé€‰æ‹©ï¼š</strong>${iirMultipliers < firMultipliers ? 'IIRæ»¤æ³¢å™¨ï¼ˆè®¡ç®—æ•ˆç‡ä¼˜åŠ¿ï¼‰' : 'FIRæ»¤æ³¢å™¨ï¼ˆçº¿æ€§ç›¸ä½ä¼˜åŠ¿ï¼‰'}</p>
            `;
        }
        
        // åˆ‡æ¢ç­”æ¡ˆæ˜¾ç¤º
        function toggleAnswer(answerId) {
            const answer = document.getElementById(answerId);
            answer.style.display = answer.style.display === 'none' ? 'block' : 'none';
        }
        
        // é¡µé¢åŠ è½½ååˆå§‹åŒ–
        window.onload = function() {
            updateLinearPhase();
            updateWindowMethod();
            updateFrequencySampling();
            updateComparison();
        };
    </script>
</body>
</html>